<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"hongxing.tech","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="红星">
<meta property="og:url" content="https://hongxing.tech/index.html">
<meta property="og:site_name" content="红星">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="wanghongxing">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://hongxing.tech/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-cn'
  };
</script>

  <title>红星</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">红星</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>Commonweal 404</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-cn">
    <link itemprop="mainEntityOfPage" href="https://hongxing.tech/20240827-%E5%AD%A6%E4%B9%A0clickhouse/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wanghongxing">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红星">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/20240827-%E5%AD%A6%E4%B9%A0clickhouse/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-08-27 16:40:46" itemprop="dateCreated datePublished" datetime="2024-08-27T16:40:46+08:00">2024-08-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-08-28 17:32:32" itemprop="dateModified" datetime="2024-08-28T17:32:32+08:00">2024-08-28</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>20240827-学习clickhouse</p>
<p>docker-compose 安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">version: &#x27;3&#x27;</span><br><span class="line">services:</span><br><span class="line">  clickhouse:</span><br><span class="line">    image: yandex/clickhouse-server</span><br><span class="line">    container_name: clickhouse</span><br><span class="line">    ports:</span><br><span class="line">      - 9009:9009</span><br><span class="line">      - 9000:9000</span><br><span class="line">      - 8123:8123</span><br><span class="line">    networks:</span><br><span class="line">      - clickhouse </span><br><span class="line">    volumes:</span><br><span class="line">      - ./clickhouse:/var/lib/clickhouse</span><br><span class="line">      - ./data:/data</span><br><span class="line"> </span><br><span class="line">networks:</span><br><span class="line">  clickhouse:</span><br><span class="line">    driver: bridge</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>苹果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./clickhouse-macos-aarch64v23.8.9.54 server</span><br></pre></td></tr></table></figure>

<p>建库：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">clickhouse<span class="operator">-</span>client <span class="comment">--host clickhouse-server</span></span><br><span class="line">clickhouse<span class="operator">-</span>client <span class="comment">--host clickhouse-server --query &quot;CREATE DATABASE IF NOT EXISTS tutorial&quot;</span></span><br></pre></td></tr></table></figure>

<p>macos</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ./clickhouse-macos-aarch64v23.8.9.54 server client</span><br><span class="line">CREATE DATABASE IF NOT EXISTS tutorial</span><br></pre></td></tr></table></figure>



<p>建表：</p>
<p>hits_v1</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> tutorial.hits_v1</span><br><span class="line">(</span><br><span class="line">    `WatchID` UInt64,</span><br><span class="line">    `JavaEnable` UInt8,</span><br><span class="line">    `Title` String,</span><br><span class="line">    `GoodEvent` Int16,</span><br><span class="line">    `EventTime` DateTime,</span><br><span class="line">    `EventDate` <span class="type">Date</span>,</span><br><span class="line">    `CounterID` UInt32,</span><br><span class="line">    `ClientIP` UInt32,</span><br><span class="line">    `ClientIP6` FixedString(<span class="number">16</span>),</span><br><span class="line">    `RegionID` UInt32,</span><br><span class="line">    `UserID` UInt64,</span><br><span class="line">    `CounterClass` Int8,</span><br><span class="line">    `OS` UInt8,</span><br><span class="line">    `UserAgent` UInt8,</span><br><span class="line">    `URL` String,</span><br><span class="line">    `Referer` String,</span><br><span class="line">    `URLDomain` String,</span><br><span class="line">    `RefererDomain` String,</span><br><span class="line">    `Refresh` UInt8,</span><br><span class="line">    `IsRobot` UInt8,</span><br><span class="line">    `RefererCategories` <span class="keyword">Array</span>(UInt16),</span><br><span class="line">    `URLCategories` <span class="keyword">Array</span>(UInt16),</span><br><span class="line">    `URLRegions` <span class="keyword">Array</span>(UInt32),</span><br><span class="line">    `RefererRegions` <span class="keyword">Array</span>(UInt32),</span><br><span class="line">    `ResolutionWidth` UInt16,</span><br><span class="line">    `ResolutionHeight` UInt16,</span><br><span class="line">    `ResolutionDepth` UInt8,</span><br><span class="line">    `FlashMajor` UInt8,</span><br><span class="line">    `FlashMinor` UInt8,</span><br><span class="line">    `FlashMinor2` String,</span><br><span class="line">    `NetMajor` UInt8,</span><br><span class="line">    `NetMinor` UInt8,</span><br><span class="line">    `UserAgentMajor` UInt16,</span><br><span class="line">    `UserAgentMinor` FixedString(<span class="number">2</span>),</span><br><span class="line">    `CookieEnable` UInt8,</span><br><span class="line">    `JavascriptEnable` UInt8,</span><br><span class="line">    `IsMobile` UInt8,</span><br><span class="line">    `MobilePhone` UInt8,</span><br><span class="line">    `MobilePhoneModel` String,</span><br><span class="line">    `Params` String,</span><br><span class="line">    `IPNetworkID` UInt32,</span><br><span class="line">    `TraficSourceID` Int8,</span><br><span class="line">    `SearchEngineID` UInt16,</span><br><span class="line">    `SearchPhrase` String,</span><br><span class="line">    `AdvEngineID` UInt8,</span><br><span class="line">    `IsArtifical` UInt8,</span><br><span class="line">    `WindowClientWidth` UInt16,</span><br><span class="line">    `WindowClientHeight` UInt16,</span><br><span class="line">    `ClientTimeZone` Int16,</span><br><span class="line">    `ClientEventTime` DateTime,</span><br><span class="line">    `SilverlightVersion1` UInt8,</span><br><span class="line">    `SilverlightVersion2` UInt8,</span><br><span class="line">    `SilverlightVersion3` UInt32,</span><br><span class="line">    `SilverlightVersion4` UInt16,</span><br><span class="line">    `PageCharset` String,</span><br><span class="line">    `CodeVersion` UInt32,</span><br><span class="line">    `IsLink` UInt8,</span><br><span class="line">    `IsDownload` UInt8,</span><br><span class="line">    `IsNotBounce` UInt8,</span><br><span class="line">    `FUniqID` UInt64,</span><br><span class="line">    `HID` UInt32,</span><br><span class="line">    `IsOldCounter` UInt8,</span><br><span class="line">    `IsEvent` UInt8,</span><br><span class="line">    `IsParameter` UInt8,</span><br><span class="line">    `DontCountHits` UInt8,</span><br><span class="line">    `WithHash` UInt8,</span><br><span class="line">    `HitColor` FixedString(<span class="number">1</span>),</span><br><span class="line">    `UTCEventTime` DateTime,</span><br><span class="line">    `Age` UInt8,</span><br><span class="line">    `Sex` UInt8,</span><br><span class="line">    `Income` UInt8,</span><br><span class="line">    `Interests` UInt16,</span><br><span class="line">    `Robotness` UInt8,</span><br><span class="line">    `GeneralInterests` <span class="keyword">Array</span>(UInt16),</span><br><span class="line">    `RemoteIP` UInt32,</span><br><span class="line">    `RemoteIP6` FixedString(<span class="number">16</span>),</span><br><span class="line">    `WindowName` Int32,</span><br><span class="line">    `OpenerName` Int32,</span><br><span class="line">    `HistoryLength` Int16,</span><br><span class="line">    `BrowserLanguage` FixedString(<span class="number">2</span>),</span><br><span class="line">    `BrowserCountry` FixedString(<span class="number">2</span>),</span><br><span class="line">    `SocialNetwork` String,</span><br><span class="line">    `SocialAction` String,</span><br><span class="line">    `HTTPError` UInt16,</span><br><span class="line">    `SendTiming` Int32,</span><br><span class="line">    `DNSTiming` Int32,</span><br><span class="line">    `ConnectTiming` Int32,</span><br><span class="line">    `ResponseStartTiming` Int32,</span><br><span class="line">    `ResponseEndTiming` Int32,</span><br><span class="line">    `FetchTiming` Int32,</span><br><span class="line">    `RedirectTiming` Int32,</span><br><span class="line">    `DOMInteractiveTiming` Int32,</span><br><span class="line">    `DOMContentLoadedTiming` Int32,</span><br><span class="line">    `DOMCompleteTiming` Int32,</span><br><span class="line">    `LoadEventStartTiming` Int32,</span><br><span class="line">    `LoadEventEndTiming` Int32,</span><br><span class="line">    `NSToDOMContentLoadedTiming` Int32,</span><br><span class="line">    `FirstPaintTiming` Int32,</span><br><span class="line">    `RedirectCount` Int8,</span><br><span class="line">    `SocialSourceNetworkID` UInt8,</span><br><span class="line">    `SocialSourcePage` String,</span><br><span class="line">    `ParamPrice` Int64,</span><br><span class="line">    `ParamOrderID` String,</span><br><span class="line">    `ParamCurrency` FixedString(<span class="number">3</span>),</span><br><span class="line">    `ParamCurrencyID` UInt16,</span><br><span class="line">    `GoalsReached` <span class="keyword">Array</span>(UInt32),</span><br><span class="line">    `OpenstatServiceName` String,</span><br><span class="line">    `OpenstatCampaignID` String,</span><br><span class="line">    `OpenstatAdID` String,</span><br><span class="line">    `OpenstatSourceID` String,</span><br><span class="line">    `UTMSource` String,</span><br><span class="line">    `UTMMedium` String,</span><br><span class="line">    `UTMCampaign` String,</span><br><span class="line">    `UTMContent` String,</span><br><span class="line">    `UTMTerm` String,</span><br><span class="line">    `FromTag` String,</span><br><span class="line">    `HasGCLID` UInt8,</span><br><span class="line">    `RefererHash` UInt64,</span><br><span class="line">    `URLHash` UInt64,</span><br><span class="line">    `CLID` UInt32,</span><br><span class="line">    `YCLID` UInt64,</span><br><span class="line">    `ShareService` String,</span><br><span class="line">    `ShareURL` String,</span><br><span class="line">    `ShareTitle` String,</span><br><span class="line">    `ParsedParams` Nested(</span><br><span class="line">        Key1 String,</span><br><span class="line">        Key2 String,</span><br><span class="line">        Key3 String,</span><br><span class="line">        Key4 String,</span><br><span class="line">        Key5 String,</span><br><span class="line">        ValueDouble Float64),</span><br><span class="line">    `IslandID` FixedString(<span class="number">16</span>),</span><br><span class="line">    `RequestNum` UInt32,</span><br><span class="line">    `RequestTry` UInt8</span><br><span class="line">)</span><br><span class="line">ENGINE <span class="operator">=</span> MergeTree()</span><br><span class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> toYYYYMM(EventDate)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> (CounterID, EventDate, intHash32(UserID))</span><br><span class="line">SAMPLE <span class="keyword">BY</span> intHash32(UserID)</span><br></pre></td></tr></table></figure>

<p>visits_v1</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> tutorial.visits_v1</span><br><span class="line">(</span><br><span class="line">    `CounterID` UInt32,</span><br><span class="line">    `StartDate` <span class="type">Date</span>,</span><br><span class="line">    `Sign` Int8,</span><br><span class="line">    `IsNew` UInt8,</span><br><span class="line">    `VisitID` UInt64,</span><br><span class="line">    `UserID` UInt64,</span><br><span class="line">    `StartTime` DateTime,</span><br><span class="line">    `Duration` UInt32,</span><br><span class="line">    `UTCStartTime` DateTime,</span><br><span class="line">    `PageViews` Int32,</span><br><span class="line">    `Hits` Int32,</span><br><span class="line">    `IsBounce` UInt8,</span><br><span class="line">    `Referer` String,</span><br><span class="line">    `StartURL` String,</span><br><span class="line">    `RefererDomain` String,</span><br><span class="line">    `StartURLDomain` String,</span><br><span class="line">    `EndURL` String,</span><br><span class="line">    `LinkURL` String,</span><br><span class="line">    `IsDownload` UInt8,</span><br><span class="line">    `TraficSourceID` Int8,</span><br><span class="line">    `SearchEngineID` UInt16,</span><br><span class="line">    `SearchPhrase` String,</span><br><span class="line">    `AdvEngineID` UInt8,</span><br><span class="line">    `PlaceID` Int32,</span><br><span class="line">    `RefererCategories` <span class="keyword">Array</span>(UInt16),</span><br><span class="line">    `URLCategories` <span class="keyword">Array</span>(UInt16),</span><br><span class="line">    `URLRegions` <span class="keyword">Array</span>(UInt32),</span><br><span class="line">    `RefererRegions` <span class="keyword">Array</span>(UInt32),</span><br><span class="line">    `IsYandex` UInt8,</span><br><span class="line">    `GoalReachesDepth` Int32,</span><br><span class="line">    `GoalReachesURL` Int32,</span><br><span class="line">    `GoalReachesAny` Int32,</span><br><span class="line">    `SocialSourceNetworkID` UInt8,</span><br><span class="line">    `SocialSourcePage` String,</span><br><span class="line">    `MobilePhoneModel` String,</span><br><span class="line">    `ClientEventTime` DateTime,</span><br><span class="line">    `RegionID` UInt32,</span><br><span class="line">    `ClientIP` UInt32,</span><br><span class="line">    `ClientIP6` FixedString(<span class="number">16</span>),</span><br><span class="line">    `RemoteIP` UInt32,</span><br><span class="line">    `RemoteIP6` FixedString(<span class="number">16</span>),</span><br><span class="line">    `IPNetworkID` UInt32,</span><br><span class="line">    `SilverlightVersion3` UInt32,</span><br><span class="line">    `CodeVersion` UInt32,</span><br><span class="line">    `ResolutionWidth` UInt16,</span><br><span class="line">    `ResolutionHeight` UInt16,</span><br><span class="line">    `UserAgentMajor` UInt16,</span><br><span class="line">    `UserAgentMinor` UInt16,</span><br><span class="line">    `WindowClientWidth` UInt16,</span><br><span class="line">    `WindowClientHeight` UInt16,</span><br><span class="line">    `SilverlightVersion2` UInt8,</span><br><span class="line">    `SilverlightVersion4` UInt16,</span><br><span class="line">    `FlashVersion3` UInt16,</span><br><span class="line">    `FlashVersion4` UInt16,</span><br><span class="line">    `ClientTimeZone` Int16,</span><br><span class="line">    `OS` UInt8,</span><br><span class="line">    `UserAgent` UInt8,</span><br><span class="line">    `ResolutionDepth` UInt8,</span><br><span class="line">    `FlashMajor` UInt8,</span><br><span class="line">    `FlashMinor` UInt8,</span><br><span class="line">    `NetMajor` UInt8,</span><br><span class="line">    `NetMinor` UInt8,</span><br><span class="line">    `MobilePhone` UInt8,</span><br><span class="line">    `SilverlightVersion1` UInt8,</span><br><span class="line">    `Age` UInt8,</span><br><span class="line">    `Sex` UInt8,</span><br><span class="line">    `Income` UInt8,</span><br><span class="line">    `JavaEnable` UInt8,</span><br><span class="line">    `CookieEnable` UInt8,</span><br><span class="line">    `JavascriptEnable` UInt8,</span><br><span class="line">    `IsMobile` UInt8,</span><br><span class="line">    `BrowserLanguage` UInt16,</span><br><span class="line">    `BrowserCountry` UInt16,</span><br><span class="line">    `Interests` UInt16,</span><br><span class="line">    `Robotness` UInt8,</span><br><span class="line">    `GeneralInterests` <span class="keyword">Array</span>(UInt16),</span><br><span class="line">    `Params` <span class="keyword">Array</span>(String),</span><br><span class="line">    `Goals` Nested(</span><br><span class="line">        ID UInt32,</span><br><span class="line">        Serial UInt32,</span><br><span class="line">        EventTime DateTime,</span><br><span class="line">        Price Int64,</span><br><span class="line">        OrderID String,</span><br><span class="line">        CurrencyID UInt32),</span><br><span class="line">    `WatchIDs` <span class="keyword">Array</span>(UInt64),</span><br><span class="line">    `ParamSumPrice` Int64,</span><br><span class="line">    `ParamCurrency` FixedString(<span class="number">3</span>),</span><br><span class="line">    `ParamCurrencyID` UInt16,</span><br><span class="line">    `ClickLogID` UInt64,</span><br><span class="line">    `ClickEventID` Int32,</span><br><span class="line">    `ClickGoodEvent` Int32,</span><br><span class="line">    `ClickEventTime` DateTime,</span><br><span class="line">    `ClickPriorityID` Int32,</span><br><span class="line">    `ClickPhraseID` Int32,</span><br><span class="line">    `ClickPageID` Int32,</span><br><span class="line">    `ClickPlaceID` Int32,</span><br><span class="line">    `ClickTypeID` Int32,</span><br><span class="line">    `ClickResourceID` Int32,</span><br><span class="line">    `ClickCost` UInt32,</span><br><span class="line">    `ClickClientIP` UInt32,</span><br><span class="line">    `ClickDomainID` UInt32,</span><br><span class="line">    `ClickURL` String,</span><br><span class="line">    `ClickAttempt` UInt8,</span><br><span class="line">    `ClickOrderID` UInt32,</span><br><span class="line">    `ClickBannerID` UInt32,</span><br><span class="line">    `ClickMarketCategoryID` UInt32,</span><br><span class="line">    `ClickMarketPP` UInt32,</span><br><span class="line">    `ClickMarketCategoryName` String,</span><br><span class="line">    `ClickMarketPPName` String,</span><br><span class="line">    `ClickAWAPSCampaignName` String,</span><br><span class="line">    `ClickPageName` String,</span><br><span class="line">    `ClickTargetType` UInt16,</span><br><span class="line">    `ClickTargetPhraseID` UInt64,</span><br><span class="line">    `ClickContextType` UInt8,</span><br><span class="line">    `ClickSelectType` Int8,</span><br><span class="line">    `ClickOptions` String,</span><br><span class="line">    `ClickGroupBannerID` Int32,</span><br><span class="line">    `OpenstatServiceName` String,</span><br><span class="line">    `OpenstatCampaignID` String,</span><br><span class="line">    `OpenstatAdID` String,</span><br><span class="line">    `OpenstatSourceID` String,</span><br><span class="line">    `UTMSource` String,</span><br><span class="line">    `UTMMedium` String,</span><br><span class="line">    `UTMCampaign` String,</span><br><span class="line">    `UTMContent` String,</span><br><span class="line">    `UTMTerm` String,</span><br><span class="line">    `FromTag` String,</span><br><span class="line">    `HasGCLID` UInt8,</span><br><span class="line">    `FirstVisit` DateTime,</span><br><span class="line">    `PredLastVisit` <span class="type">Date</span>,</span><br><span class="line">    `LastVisit` <span class="type">Date</span>,</span><br><span class="line">    `TotalVisits` UInt32,</span><br><span class="line">    `TraficSource` Nested(</span><br><span class="line">        ID Int8,</span><br><span class="line">        SearchEngineID UInt16,</span><br><span class="line">        AdvEngineID UInt8,</span><br><span class="line">        PlaceID UInt16,</span><br><span class="line">        SocialSourceNetworkID UInt8,</span><br><span class="line">        Domain String,</span><br><span class="line">        SearchPhrase String,</span><br><span class="line">        SocialSourcePage String),</span><br><span class="line">    `Attendance` FixedString(<span class="number">16</span>),</span><br><span class="line">    `CLID` UInt32,</span><br><span class="line">    `YCLID` UInt64,</span><br><span class="line">    `NormalizedRefererHash` UInt64,</span><br><span class="line">    `SearchPhraseHash` UInt64,</span><br><span class="line">    `RefererDomainHash` UInt64,</span><br><span class="line">    `NormalizedStartURLHash` UInt64,</span><br><span class="line">    `StartURLDomainHash` UInt64,</span><br><span class="line">    `NormalizedEndURLHash` UInt64,</span><br><span class="line">    `TopLevelDomain` UInt64,</span><br><span class="line">    `URLScheme` UInt64,</span><br><span class="line">    `OpenstatServiceNameHash` UInt64,</span><br><span class="line">    `OpenstatCampaignIDHash` UInt64,</span><br><span class="line">    `OpenstatAdIDHash` UInt64,</span><br><span class="line">    `OpenstatSourceIDHash` UInt64,</span><br><span class="line">    `UTMSourceHash` UInt64,</span><br><span class="line">    `UTMMediumHash` UInt64,</span><br><span class="line">    `UTMCampaignHash` UInt64,</span><br><span class="line">    `UTMContentHash` UInt64,</span><br><span class="line">    `UTMTermHash` UInt64,</span><br><span class="line">    `FromHash` UInt64,</span><br><span class="line">    `WebVisorEnabled` UInt8,</span><br><span class="line">    `WebVisorActivity` UInt32,</span><br><span class="line">    `ParsedParams` Nested(</span><br><span class="line">        Key1 String,</span><br><span class="line">        Key2 String,</span><br><span class="line">        Key3 String,</span><br><span class="line">        Key4 String,</span><br><span class="line">        Key5 String,</span><br><span class="line">        ValueDouble Float64),</span><br><span class="line">    `Market` Nested(</span><br><span class="line">        Type UInt8,</span><br><span class="line">        GoalID UInt32,</span><br><span class="line">        OrderID String,</span><br><span class="line">        OrderPrice Int64,</span><br><span class="line">        PP UInt32,</span><br><span class="line">        DirectPlaceID UInt32,</span><br><span class="line">        DirectOrderID UInt32,</span><br><span class="line">        DirectBannerID UInt32,</span><br><span class="line">        GoodID String,</span><br><span class="line">        GoodName String,</span><br><span class="line">        GoodQuantity Int32,</span><br><span class="line">        GoodPrice Int64),</span><br><span class="line">    `IslandID` FixedString(<span class="number">16</span>)</span><br><span class="line">)</span><br><span class="line">ENGINE <span class="operator">=</span> CollapsingMergeTree(Sign)</span><br><span class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> toYYYYMM(StartDate)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> (CounterID, StartDate, intHash32(UserID), VisitID)</span><br><span class="line">SAMPLE <span class="keyword">BY</span> intHash32(UserID)</span><br></pre></td></tr></table></figure>

<p>导入数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">clickhouse-client --host clickhouse-server --query &quot;INSERT INTO tutorial.hits_v1 FORMAT TSV&quot; --max_insert_block_size=100000 &lt; hits_v1.tsv</span><br><span class="line">clickhouse-client --host clickhouse-server --query &quot;INSERT INTO tutorial.visits_v1 FORMAT TSV&quot; --max_insert_block_size=100000 &lt; visits_v1.tsv</span><br></pre></td></tr></table></figure>

<p>macos</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./clickhouse-macos-aarch64v23.8.9.54   client --query &quot;INSERT INTO tutorial.hits_v1 FORMAT TSV&quot; --max_insert_block_size=100000 &lt; ~/docker/clickhouse/data/hits_v1.tsv</span><br><span class="line">./clickhouse-macos-aarch64v23.8.9.54   client --query &quot;INSERT INTO tutorial.visits_v1 FORMAT TSV&quot; --max_insert_block_size=100000 &lt; ~/docker/clickhouse/data/visits_v1.tsv</span><br></pre></td></tr></table></figure>

<p>比较发现，直接启动的比虚拟机里面的快两个数量级，虚拟机应该是在arm上跑了intel的程序。</p>
<p>查询</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">:) SELECT COUNT(*) FROM tutorial.hits_v1</span><br><span class="line">┌─count()─┐</span><br><span class="line">│ 8873898 │</span><br><span class="line">└─────────┘</span><br><span class="line"></span><br><span class="line">1 row in set. Elapsed: 0.005 sec.</span><br><span class="line"></span><br><span class="line">:) SELECT COUNT(*) FROM tutorial.visits_v1</span><br><span class="line">Query id: acab693b-3d8d-4c72-8a51-7be2fa68be3a</span><br><span class="line"></span><br><span class="line">┌─count()─┐</span><br><span class="line">│ 1680609 │</span><br><span class="line">└─────────┘</span><br><span class="line"></span><br><span class="line">1 row in set. Elapsed: 0.042 sec.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">:) SELECT</span><br><span class="line">    StartURL AS URL,</span><br><span class="line">    AVG(Duration) AS AvgDuration</span><br><span class="line">FROM tutorial.visits_v1</span><br><span class="line">WHERE StartDate BETWEEN &#x27;2014-03-23&#x27; AND &#x27;2014-03-30&#x27;</span><br><span class="line">GROUP BY URL</span><br><span class="line">ORDER BY AvgDuration DESC</span><br><span class="line">LIMIT 10</span><br><span class="line"></span><br><span class="line">:) SELECT</span><br><span class="line">    sum(Sign) AS visits,</span><br><span class="line">    sumIf(Sign, has(Goals.ID, 1105530)) AS goal_visits,</span><br><span class="line">    (100. * goal_visits) / visits AS goal_percent</span><br><span class="line">FROM tutorial.visits_v1</span><br><span class="line">WHERE (CounterID = 912887) AND (toYYYYMM(StartDate) = 201403) AND (domain(StartURL) = &#x27;yandex.ru&#x27;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><a target="_blank" rel="noopener" href="https://builds.clickhouse.com/master/macos-aarch64">https://builds.clickhouse.com/master/macos-aarch64</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-cn">
    <link itemprop="mainEntityOfPage" href="https://hongxing.tech/20240827-%E4%BD%BF%E7%94%A8rocketmq/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wanghongxing">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红星">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/20240827-%E4%BD%BF%E7%94%A8rocketmq/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2024-08-27 15:46:58 / Modified: 16:19:08" itemprop="dateCreated datePublished" datetime="2024-08-27T15:46:58+08:00">2024-08-27</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>20240827-使用rocketmq</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install java-1.8.0-openjdk-devel.x86_64</span><br></pre></td></tr></table></figure>

<p>rocketmq-all-5.1.0-bin-release</p>
<p>运行namesrv</p>
<p><code>nohup sh mqnamesrv &amp;</code></p>
<p>修改run broken.sh 添加如下行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JAVA_OPT=&quot;$&#123;JAVA_OPT&#125;  --add-exports=java.base/sun.nio.ch=ALL-UNNAMED&quot;</span><br></pre></td></tr></table></figure>

<p> 然后启动broker</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ sh ./bin/mqbroker -n 172.16.40.24:9876 -c conf/broker.conf</span><br><span class="line">The broker[broker-a, 172.16.40.24:10911] boot success. serializeType=JSON and name server is 192.168.31.99:9876</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$ sudo firewall-cmd --zone=public --add-port=9876/tcp --permanent</span><br><span class="line">$ sudo firewall-cmd --zone=public --add-port=10911/tcp --permanent</span><br><span class="line">$ sudo firewall-cmd --reload</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p> 通过mqadmin创建 Topic。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"> $ </span><span class="language-bash">./bin/mqadmin updateTopic -t TopicTest -c DefaultCluster -n 172.16.40.24:9876</span></span><br><span class="line">create topic to 192.168.31.99:10911 success.</span><br><span class="line">TopicConfig [topicName=TopicTest, readQueueNums=8, writeQueueNums=8, perm=RW-, topicFilterType=SINGLE_TAG, topicSysFlag=0, order=false, attributes=&#123;&#125;]</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>producer</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">export</span>   NAMESRV_ADDR=172.16.40.24:9876</span><br><span class="line">$ ./bin/tools.sh  org.apache.rocketmq.example.quickstart.Producer</span><br><span class="line">$ ./bin/tools.sh org.apache.rocketmq.example.quickstart.Consumer</span><br></pre></td></tr></table></figure>

<p>运行rocketmq-dashboard</p>
<p>docker</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">version: &#x27;3.3&#x27;</span><br><span class="line">services:</span><br><span class="line">  rocketmq-dashboard:</span><br><span class="line">    image: apacherocketmq/rocketmq-dashboard:latest</span><br><span class="line">    container_name: rocketmq-dashboard</span><br><span class="line">    networks:</span><br><span class="line">      - rocketmq</span><br><span class="line">    ports:</span><br><span class="line">      - 8080:8080</span><br><span class="line">    environment:</span><br><span class="line">      - JAVA_OPTS=-Drocketmq.namesrv.addr=172.16.40.24:9876</span><br><span class="line">networks:</span><br><span class="line">  rocketmq:</span><br><span class="line">    driver: bridge</span><br></pre></td></tr></table></figure>

<p>打开防火墙</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo firewall-cmd --zone=public --add-port=8080/tcp --permanent</span><br><span class="line">$ sudo firewall-cmd --reload</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-cn">
    <link itemprop="mainEntityOfPage" href="https://hongxing.tech/2024-823-minio-%E5%AD%A6%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wanghongxing">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红星">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024-823-minio-%E5%AD%A6%E4%B9%A0/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-08-23 11:28:44" itemprop="dateCreated datePublished" datetime="2024-08-23T11:28:44+08:00">2024-08-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-08-26 10:32:39" itemprop="dateModified" datetime="2024-08-26T10:32:39+08:00">2024-08-26</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>minio 学习</p>
<p>minio 172.165.40.4</p>
<p><a target="_blank" rel="noopener" href="http://minio-console.haowujidian.com/">http://minio-console.haowujidian.com</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">accesskey: lOaMW50t9UdiolW3hAHN</span><br><span class="line">secretKey: omDmGbg4qGlQY1ukPzDgH39DncRZf7qNtmC3o9hx</span><br></pre></td></tr></table></figure>

<p>windows下使用mc.exe </p>
<p><a target="_blank" rel="noopener" href="http://dl.minio.org.cn/client/mc/release/windows-amd64/mc.exe">http://dl.minio.org.cn/client/mc/release/windows-amd64/mc.exe</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mc.exe alias set whx http://172.16.40.24:9000 whx Whxheart0210</span><br><span class="line">mc.exe alias set whx http://minio.haowujidian.com whx Whxheart0210</span><br><span class="line"></span><br><span class="line">./mc.exe admin info whx</span><br><span class="line">./mc.exe cp --recusive ediplusx64 whx/pubimage/</span><br><span class="line"></span><br><span class="line">./mc.exe ls whx/pubimage/</span><br></pre></td></tr></table></figure>

<p>rclone 用于在云存储和本地存储之间的同步、复制</p>
<p>windows:下载地址： <a target="_blank" rel="noopener" href="https://rclone.org/downloads/">https://rclone.org/downloads/</a></p>
<p>配置文件</p>
<p>C:\Users\whxhe\AppData\Roaming\rclone\rclone.conf</p>
<p>macos:</p>
<p>~/.config/rclone/rclone.conf</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[whx]</span><br><span class="line">type = s3</span><br><span class="line">provider = Other</span><br><span class="line">env_auth = false</span><br><span class="line">access_key_id  = lOaMW50t9UdiolW3hAHN</span><br><span class="line">secret_access_key= omDmGbg4qGlQY1ukPzDgH39DncRZf7qNtmC3o9hx</span><br><span class="line">endpoint = http://minio.haowujidian.com</span><br></pre></td></tr></table></figure>

<p>同步目录</p>
<p><code>rclone sync d:\soft\whx whx:/pubimage/whx</code></p>
<p>查看目录</p>
<p><code>rclone ls whx:\pubimage\whx</code></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-cn">
    <link itemprop="mainEntityOfPage" href="https://hongxing.tech/centos7%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%AE%89%E8%A3%85docker/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wanghongxing">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红星">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/centos7%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%AE%89%E8%A3%85docker/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-08-07 15:20:00" itemprop="dateCreated datePublished" datetime="2024-08-07T15:20:00+08:00">2024-08-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-12-12 18:18:01" itemprop="dateModified" datetime="2024-12-12T18:18:01+08:00">2024-12-12</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>centos7服务器安装docker</p>
<p>修改 yum 软件源</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo</span><br><span class="line">yum clean all</span><br><span class="line">yum makecache</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yum update</span><br><span class="line">yum install -y yum-utils \</span><br><span class="line">  device-mapper-persistent-data \</span><br><span class="line">  lvm2</span><br></pre></td></tr></table></figure>

<p>添加 Docker 稳定版本的 yum 软件源</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">yum-config-manager \</span><br><span class="line">    --add-repo \</span><br><span class="line">    https://mirrors.ustc.edu.cn/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">sed -i &#x27;s+https://download.docker.com+https://mirrors.tuna.tsinghua.edu.cn/docker-ce+&#x27; /etc/yum.repos.d/docker-ce.repo</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>安装 Docker</p>
<p>更新一下 yum 软件源的缓存，并安装 Docker。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum update</span><br><span class="line">yum install docker-ce</span><br></pre></td></tr></table></figure>

<p>至此，Docker 已经安装完成了，Docker 服务是没有启动的，操作系统里的 docker 组被创建，但是没有用户在这个组里。</p>
<p># Install docker-compose</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -L https://github.com/docker/compose/releases/download/2.29.0/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose</span><br><span class="line"></span><br><span class="line">chmod +x /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure>

<p><strong>注意</strong></p>
<p> 默认的 docker 组是没有用户的（也就是说需要使用 sudo 才能使用 docker 命令）。</p>
<p>您可以将用户添加到 docker 组中（此用户就可以直接使用 docker 命令了）。</p>
<p>加入 docker 用户组命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">whoami</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">#记录下当前用户名</span></span></span><br><span class="line">usermod -a -G docker USERNAME # Add current user to the docker group</span><br></pre></td></tr></table></figure>

<p>启动 Docker</p>
<p>如果想添加到开机启动</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable docker</span><br></pre></td></tr></table></figure>

<p>启动 docker 服务</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start docker</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-cn">
    <link itemprop="mainEntityOfPage" href="https://hongxing.tech/20240717-%E5%88%86%E5%8C%BA%E6%8E%92%E5%BA%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wanghongxing">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红星">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/20240717-%E5%88%86%E5%8C%BA%E6%8E%92%E5%BA%8F/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2024-07-17 18:57:34 / Modified: 19:04:57" itemprop="dateCreated datePublished" datetime="2024-07-17T18:57:34+08:00">2024-07-17</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>分区排序</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span>   baseinfo_tb_b_carclass m <span class="keyword">INNER</span> <span class="keyword">JOIN</span> (</span><br><span class="line"><span class="keyword">select</span> brand_id,class_id ,<span class="built_in">ROW_NUMBER</span>() <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> BRAND_ID <span class="keyword">ORDER</span> <span class="keyword">BY</span> class_id,class_name) <span class="keyword">AS</span> sub_index</span><br><span class="line"><span class="keyword">from</span> baseinfo_tb_b_carclass m1 </span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> brand_id ,class_id</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> brand_id,sub_index</span><br><span class="line">) mi </span><br><span class="line"><span class="keyword">on</span> mi.class_id<span class="operator">=</span>m.class_id  </span><br><span class="line"><span class="keyword">set</span> m.show_order<span class="operator">=</span>mi.sub_index;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> baseinfo_tb_b_carclass <span class="keyword">set</span> show_order<span class="operator">=</span><span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span>   baseinfo_tb_b_carclass m <span class="keyword">INNER</span> <span class="keyword">JOIN</span> (</span><br><span class="line"><span class="keyword">select</span> brand_id,class_id ,<span class="built_in">ROW_NUMBER</span>() <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> BRAND_ID <span class="keyword">ORDER</span> <span class="keyword">BY</span> class_id,class_name) <span class="keyword">AS</span> sub_index</span><br><span class="line"><span class="keyword">from</span> baseinfo_tb_b_carclass m1 </span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> brand_id ,class_id</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> brand_id,sub_index</span><br><span class="line">) mi </span><br><span class="line"><span class="keyword">on</span> mi.class_id<span class="operator">=</span>m.class_id  </span><br><span class="line"><span class="keyword">set</span> m.show_order<span class="operator">=</span>mi.sub_index;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> m1.id,m1.dim,m1.dim_real,m1.cal_order,m1.show_order, m1.cal_order <span class="operator">+</span> mi.sub_index <span class="operator">*</span> POW(<span class="number">100</span>, mi.pow),mi.pow,mi.sub_index,POW(<span class="number">100</span>, mi.pow)</span><br><span class="line"><span class="keyword">from</span>  cem_metrics m1 <span class="keyword">INNER</span> <span class="keyword">JOIN</span> (<span class="keyword">select</span> <span class="keyword">distinct</span> store , dim, sub_code,  sub_index,pow</span><br><span class="line"><span class="keyword">from</span> cem_metrics m2</span><br><span class="line"><span class="keyword">where</span> m2.dim <span class="keyword">like</span> &quot;%_$&quot; <span class="keyword">and</span> m2.sub_code <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">and</span> m2.sub_code <span class="operator">!=</span><span class="string">&#x27;0&#x27;</span>  ) mi</span><br><span class="line"><span class="keyword">on</span>  mi.store<span class="operator">=</span>m1.store <span class="keyword">and</span> mi.dim<span class="operator">=</span>m1.dim_root <span class="keyword">and</span> mi.sub_code <span class="operator">=</span> m1.sub_code</span><br><span class="line"> <span class="keyword">where</span> m1.variable<span class="operator">=</span><span class="number">1</span></span><br><span class="line"><span class="keyword">and</span> m1.sub_code <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> </span><br><span class="line"><span class="keyword">and</span> m1.sub_code <span class="operator">!=</span><span class="string">&#x27;0&#x27;</span></span><br><span class="line"><span class="keyword">and</span> m1.store <span class="operator">=</span> <span class="string">&#x27;nm00012164&#x27;</span></span><br><span class="line"><span class="keyword">and</span> m1.month<span class="operator">=</span><span class="number">4</span></span><br><span class="line"><span class="keyword">and</span> m1.dim <span class="keyword">like</span> <span class="string">&#x27;REV_YS_FIN_NC_FY_$%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> m1.id,m1.dim,m1.dim_real,m1.cal_order,m1.show_order, m1.cal_order <span class="operator">+</span> mi.sub_index <span class="operator">*</span> POW(<span class="number">100</span>, mi.pow),mi.pow,mi.sub_index,POW(<span class="number">100</span>, mi.pow)</span><br><span class="line"><span class="keyword">from</span>  cem_metrics m1 <span class="keyword">INNER</span> <span class="keyword">JOIN</span> (<span class="keyword">select</span> <span class="keyword">distinct</span> store , dim, sub_code,  sub_index,pow</span><br><span class="line"><span class="keyword">from</span> cem_metrics m2</span><br><span class="line"><span class="keyword">where</span> m2.dim <span class="keyword">like</span> &quot;%_$&quot; <span class="keyword">and</span> m2.sub_code <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">and</span> m2.sub_code <span class="operator">!=</span><span class="string">&#x27;0&#x27;</span>  ) mi</span><br><span class="line"><span class="keyword">on</span>  mi.store<span class="operator">=</span>m1.store <span class="keyword">and</span> mi.dim<span class="operator">=</span>m1.dim_root <span class="keyword">and</span> mi.sub_code <span class="operator">=</span> m1.sub_code</span><br><span class="line"> <span class="keyword">where</span> m1.variable<span class="operator">=</span><span class="number">1</span></span><br><span class="line"><span class="keyword">and</span> m1.sub_code <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> </span><br><span class="line"><span class="keyword">and</span> m1.sub_code <span class="operator">!=</span><span class="string">&#x27;0&#x27;</span></span><br><span class="line"><span class="keyword">and</span> m1.store <span class="operator">=</span> <span class="string">&#x27;nm00012164&#x27;</span></span><br><span class="line"><span class="keyword">and</span> m1.month<span class="operator">=</span><span class="number">6</span></span><br><span class="line"><span class="keyword">and</span> m1.dim <span class="keyword">like</span> <span class="string">&#x27;REV_YS_FIN_NC_FY_%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="keyword">update</span> cem_metrics m1 <span class="keyword">INNER</span> <span class="keyword">JOIN</span> (<span class="keyword">select</span> <span class="keyword">distinct</span> store , dim, sub_code,  sub_index,pow</span><br><span class="line"><span class="keyword">from</span> cem_metrics m2</span><br><span class="line"><span class="keyword">where</span> m2.dim <span class="keyword">like</span> &quot;%_$&quot; <span class="keyword">and</span> m2.sub_code <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">and</span> m2.sub_code <span class="operator">!=</span><span class="string">&#x27;0&#x27;</span>  ) mi</span><br><span class="line"><span class="keyword">on</span>  mi.store<span class="operator">=</span>m1.store <span class="keyword">and</span> mi.dim<span class="operator">=</span>m1.dim_root <span class="keyword">and</span> mi.sub_code <span class="operator">=</span> m1.sub_code</span><br><span class="line"><span class="keyword">set</span> m1.show_order<span class="operator">=</span>m1.cal_order <span class="operator">+</span> mi.sub_index <span class="operator">*</span> POW(<span class="number">100</span>, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">where</span> m1.variable<span class="operator">=</span><span class="number">1</span></span><br><span class="line"><span class="keyword">and</span> m1.sub_code <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> </span><br><span class="line"><span class="keyword">and</span> m1.sub_code <span class="operator">!=</span><span class="string">&#x27;0&#x27;</span></span><br><span class="line"><span class="keyword">and</span> m1.store <span class="operator">=</span> <span class="string">&#x27;nm00012164&#x27;</span></span><br><span class="line"><span class="keyword">and</span> m1.month<span class="operator">=</span><span class="number">4</span></span><br><span class="line"><span class="keyword">and</span> m1.dim <span class="keyword">like</span> <span class="string">&#x27;BAS_NC_INVCNT_DEC_SUB%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> cem_metrics m</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> cem_dim d </span><br><span class="line"><span class="keyword">on</span> d.code <span class="operator">=</span> m.dim</span><br><span class="line"><span class="keyword">set</span> m.name <span class="operator">=</span> d.name,m.cal_order<span class="operator">=</span>d.cal_order,m.show_order<span class="operator">=</span>d.cal_order,m.dim_parent <span class="operator">=</span> d.parent_id</span><br><span class="line">,m.dim_root<span class="operator">=</span>d.root_id,m.pow<span class="operator">=</span>d.pow,m.variable<span class="operator">=</span>d.variable,m.val_type<span class="operator">=</span>d.val_type ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span>   cem_metrics m <span class="keyword">INNER</span> <span class="keyword">JOIN</span> (<span class="keyword">select</span> store , dim, sub_code,<span class="built_in">ROW_NUMBER</span>() <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> store,dim <span class="keyword">ORDER</span> <span class="keyword">BY</span> store,dim) <span class="keyword">AS</span> sub_index</span><br><span class="line"><span class="keyword">from</span> cem_metrics m1 </span><br><span class="line"><span class="keyword">where</span>   dim <span class="keyword">like</span> &quot;%_$&quot; <span class="keyword">and</span> sub_code <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">and</span> sub_code <span class="operator">!=</span><span class="string">&#x27;0&#x27;</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> store,dim, sub_code</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> store,dim, sub_code) mi </span><br><span class="line"><span class="keyword">on</span> mi.store<span class="operator">=</span>m.store <span class="keyword">and</span> mi.dim<span class="operator">=</span>m.dim <span class="keyword">and</span> mi.sub_code <span class="operator">=</span> m.sub_code</span><br><span class="line"><span class="keyword">set</span> m.sub_index<span class="operator">=</span>mi.sub_index;</span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span>  cem_metrics m </span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> cem_dim dim <span class="keyword">on</span> dim.code <span class="operator">=</span> m.dim <span class="keyword">and</span> dim.has_sub_detail<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> dim.sub_detail_type<span class="operator">=</span><span class="number">1</span></span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> baseinfo_tb_b_carclass c <span class="keyword">on</span> c.CLASS_CODE <span class="operator">=</span>m.sub_code</span><br><span class="line"><span class="keyword">set</span> m.sub_index <span class="operator">=</span>c.show_order;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> cem_metrics <span class="keyword">set</span> show_order<span class="operator">=</span>cal_order;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> <span class="keyword">select</span> m1.id,m1.dim,m1.dim_root,m1.cal_order,m1.pow,mi.cal_order,mi.show_order,<span class="keyword">CONVERT</span>(mi.show_order <span class="operator">+</span> m1.sub_index <span class="operator">*</span> POW(<span class="number">100</span>, m1.pow),<span class="type">char</span>)</span><br><span class="line"><span class="keyword">from</span> 	cem_metrics m1 <span class="keyword">INNER</span> <span class="keyword">JOIN</span> (<span class="keyword">select</span> <span class="keyword">distinct</span> store , dim,dim_root, sub_code,  sub_index,pow,cal_order,show_order</span><br><span class="line"><span class="keyword">from</span> cem_metrics m2</span><br><span class="line"><span class="keyword">where</span> m2.dim <span class="keyword">like</span> &quot;%_$&quot;  <span class="keyword">and</span> m2.dim_root<span class="operator">=</span>m2.dim  <span class="keyword">and</span> m2.sub_code <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">and</span> m2.sub_code <span class="operator">!=</span><span class="string">&#x27;0&#x27;</span>  ) mi</span><br><span class="line"><span class="keyword">on</span>  mi.store<span class="operator">=</span>m1.store <span class="keyword">and</span> mi.dim<span class="operator">=</span>m1.dim_root <span class="keyword">and</span> mi.sub_code <span class="operator">=</span> m1.sub_code</span><br><span class="line"><span class="keyword">where</span> m1.variable<span class="operator">=</span><span class="number">1</span></span><br><span class="line"><span class="keyword">and</span> m1.dim <span class="operator">!=</span> m1.dim_root</span><br><span class="line"><span class="keyword">and</span> m1.dim <span class="operator">=</span><span class="string">&#x27;REV_NC_SALE_RETAIL_$_AVG&#x27;</span></span><br><span class="line"><span class="keyword">and</span> m1.store<span class="operator">=</span><span class="string">&#x27;nm00012164&#x27;</span></span><br><span class="line"><span class="keyword">and</span> m1.`<span class="keyword">month</span>`<span class="operator">=</span><span class="number">6</span>;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">update</span> cem_metrics    </span><br><span class="line"><span class="keyword">set</span> show_order<span class="operator">=</span>cal_order <span class="operator">+</span> sub_index <span class="operator">*</span> POW(<span class="number">100</span>, pow)</span><br><span class="line"><span class="keyword">where</span>  dim <span class="keyword">like</span> &quot;%_$&quot; <span class="keyword">and</span> dim_root<span class="operator">=</span>dim  <span class="keyword">and</span>  sub_code <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">and</span>  sub_code <span class="operator">!=</span><span class="string">&#x27;0&#x27;</span>  </span><br><span class="line"> <span class="keyword">and</span> variable<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> <span class="keyword">update</span> cem_metrics m1 <span class="keyword">INNER</span> <span class="keyword">JOIN</span> (<span class="keyword">select</span> <span class="keyword">distinct</span> store , dim, sub_code,  sub_index,pow,cal_order,show_order</span><br><span class="line"><span class="keyword">from</span> cem_metrics m2</span><br><span class="line"><span class="keyword">where</span> m2.dim <span class="keyword">like</span> &quot;%_$&quot;  <span class="keyword">and</span> m2.dim_root<span class="operator">=</span>m2.dim  <span class="keyword">and</span> m2.sub_code <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">and</span> m2.sub_code <span class="operator">!=</span><span class="string">&#x27;0&#x27;</span>  ) mi</span><br><span class="line"><span class="keyword">on</span>  mi.store<span class="operator">=</span>m1.store <span class="keyword">and</span> mi.dim<span class="operator">=</span>m1.dim_root <span class="keyword">and</span> mi.sub_code <span class="operator">=</span> m1.sub_code</span><br><span class="line"><span class="keyword">set</span> m1.show_order<span class="operator">=</span>mi.show_order <span class="operator">+</span> m1.sub_index <span class="operator">*</span> POW(<span class="number">100</span>, m1.pow)</span><br><span class="line"><span class="keyword">where</span> m1.variable<span class="operator">=</span><span class="number">1</span></span><br><span class="line"><span class="keyword">and</span> m1.dim <span class="operator">!=</span> m1.dim_root;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> cem_metrics m</span><br><span class="line"><span class="keyword">set</span> m.show_name <span class="operator">=</span> m.name ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> cem_metrics m</span><br><span class="line"><span class="keyword">set</span> m.show_name <span class="operator">=</span> m.sub_name</span><br><span class="line"><span class="keyword">where</span>   m.dim <span class="keyword">like</span> &quot;%_$&quot; <span class="keyword">and</span> m.sub_code <span class="operator">!=</span><span class="string">&#x27;0&#x27;</span> <span class="keyword">and</span>  m.sub_code <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">update</span> cem_metrics <span class="keyword">set</span> dim_real <span class="operator">=</span> dim   <span class="keyword">where</span> variable<span class="operator">=</span><span class="number">0</span>;</span><br><span class="line"> <span class="keyword">update</span> cem_metrics <span class="keyword">set</span> dim_real <span class="operator">=</span>replace(dim,&quot;$&quot;,sub_code)  <span class="keyword">where</span> variable<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line">  <span class="keyword">update</span> cem_metrics <span class="keyword">set</span> dim_real_parent <span class="operator">=</span> dim_parent   <span class="keyword">where</span> variable<span class="operator">=</span><span class="number">0</span>;</span><br><span class="line"> <span class="keyword">update</span> cem_metrics <span class="keyword">set</span> dim_real_parent <span class="operator">=</span>replace(dim_parent,&quot;$&quot;,sub_code)  <span class="keyword">where</span> variable<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-cn">
    <link itemprop="mainEntityOfPage" href="https://hongxing.tech/20240712-%E5%AF%B9nginx%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E8%BF%9B%E8%A1%8C%E5%A4%87%E4%BB%BD%E5%92%8C%E5%88%A0%E9%99%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wanghongxing">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红星">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/20240712-%E5%AF%B9nginx%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E8%BF%9B%E8%A1%8C%E5%A4%87%E4%BB%BD%E5%92%8C%E5%88%A0%E9%99%A4/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-07-12 09:36:23" itemprop="dateCreated datePublished" datetime="2024-07-12T09:36:23+08:00">2024-07-12</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>对nginx日志文件进行备份和删除</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">###########定时器（手动复制以下命令执行）############################################</span></span><br><span class="line"><span class="comment">#######每天凌晨执行###########</span></span><br><span class="line"><span class="comment">#crontab -e</span></span><br><span class="line"><span class="comment">#1 0 0 * * ? /data/log/rotate.sh</span></span><br><span class="line"><span class="comment">#systemctl start crond</span></span><br><span class="line"><span class="comment">#systemctl enable crond</span></span><br><span class="line"><span class="comment">###########定时器####################################################################</span></span><br><span class="line"><span class="comment">#/bin/sh: /data/log/rotate.sh: 权限不够</span></span><br><span class="line"><span class="comment">#执行以下命令</span></span><br><span class="line"><span class="comment">#find . -name &#x27;rotate.sh&#x27; | xargs chmod 775</span></span><br><span class="line"><span class="comment">##########nginx压缩##################################################################</span></span><br><span class="line">DATE=$(<span class="built_in">date</span> +<span class="string">&#x27;%Y%m%d%H%M%S&#x27;</span>)</span><br><span class="line"><span class="comment">##########nginx的路径################################################################</span></span><br><span class="line">nginx_log_path=/data/log/nginx</span><br><span class="line"><span class="comment">##########nginx日志备份的路径########################################################</span></span><br><span class="line">nginx_log_bak_path=/data/log/nginx</span><br><span class="line"></span><br><span class="line"><span class="built_in">mkdir</span> -p <span class="variable">$nginx_log_bak_path</span>/<span class="variable">$DATE</span></span><br><span class="line"><span class="built_in">mv</span> <span class="variable">$nginx_log_path</span>/logs/access.log <span class="variable">$nginx_log_bak_path</span>/<span class="variable">$DATE</span>/access.<span class="variable">$DATE</span>.<span class="built_in">log</span></span><br><span class="line"><span class="built_in">mv</span> <span class="variable">$nginx_log_path</span>/logs/error.log <span class="variable">$nginx_log_bak_path</span>/<span class="variable">$DATE</span>/error.<span class="variable">$DATE</span>.<span class="built_in">log</span></span><br><span class="line"><span class="built_in">mv</span> <span class="variable">$nginx_log_path</span>/logs/dongge-access.log <span class="variable">$nginx_log_bak_path</span>/<span class="variable">$DATE</span>/dongge-access.<span class="variable">$DATE</span>.<span class="built_in">log</span></span><br><span class="line"><span class="built_in">mv</span> <span class="variable">$nginx_log_path</span>/logs/dongge-error.log <span class="variable">$nginx_log_bak_path</span>/<span class="variable">$DATE</span>/dongge-error.<span class="variable">$DATE</span>.<span class="built_in">log</span></span><br><span class="line"><span class="built_in">mv</span> <span class="variable">$nginx_log_path</span>/logs/newerp-access.log <span class="variable">$nginx_log_bak_path</span>/<span class="variable">$DATE</span>/newerp-access.<span class="variable">$DATE</span>.<span class="built_in">log</span></span><br><span class="line"><span class="built_in">mv</span> <span class="variable">$nginx_log_path</span>/logs/newerp-error.log <span class="variable">$nginx_log_bak_path</span>/<span class="variable">$DATE</span>/newerp-error.<span class="variable">$DATE</span>.<span class="built_in">log</span></span><br><span class="line"><span class="built_in">mv</span> <span class="variable">$nginx_log_path</span>/logs/olderp-access.log <span class="variable">$nginx_log_bak_path</span>/<span class="variable">$DATE</span>/olderp-access.<span class="variable">$DATE</span>.<span class="built_in">log</span></span><br><span class="line"><span class="built_in">mv</span> <span class="variable">$nginx_log_path</span>/logs/olderp-error.log <span class="variable">$nginx_log_bak_path</span>/<span class="variable">$DATE</span>/olderp-error.<span class="variable">$DATE</span>.<span class="built_in">log</span></span><br><span class="line"><span class="built_in">kill</span> -USR1 `<span class="built_in">cat</span> /var/run/nginx.pid/nginx.pid`</span><br><span class="line"><span class="built_in">sleep</span> 1</span><br><span class="line">gzip <span class="variable">$nginx_log_bak_path</span>/<span class="variable">$DATE</span>/access.<span class="variable">$DATE</span>.<span class="built_in">log</span></span><br><span class="line">gzip <span class="variable">$nginx_log_bak_path</span>/<span class="variable">$DATE</span>/error.<span class="variable">$DATE</span>.<span class="built_in">log</span></span><br><span class="line">gzip <span class="variable">$nginx_log_bak_path</span>/<span class="variable">$DATE</span>/dongge-access.<span class="variable">$DATE</span>.<span class="built_in">log</span></span><br><span class="line">gzip <span class="variable">$nginx_log_bak_path</span>/<span class="variable">$DATE</span>/dongge-error.<span class="variable">$DATE</span>.<span class="built_in">log</span></span><br><span class="line">gzip <span class="variable">$nginx_log_bak_path</span>/<span class="variable">$DATE</span>/newerp-access.<span class="variable">$DATE</span>.<span class="built_in">log</span></span><br><span class="line">gzip <span class="variable">$nginx_log_bak_path</span>/<span class="variable">$DATE</span>/newerp-error.<span class="variable">$DATE</span>.<span class="built_in">log</span></span><br><span class="line">gzip <span class="variable">$nginx_log_bak_path</span>/<span class="variable">$DATE</span>/olderp-access.<span class="variable">$DATE</span>.<span class="built_in">log</span></span><br><span class="line">gzip <span class="variable">$nginx_log_bak_path</span>/<span class="variable">$DATE</span>/olderp-error.<span class="variable">$DATE</span>.<span class="built_in">log</span></span><br><span class="line"><span class="comment">#########nginx压缩####################################################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#########删除文件（仅保存180天的备份数据）############################################</span></span><br><span class="line">find <span class="variable">$nginx_log_bak_path</span> -mtime +30 -name <span class="string">&quot;*.log&quot;</span> -<span class="built_in">exec</span> <span class="built_in">rm</span> -rf &#123;&#125; \;</span><br><span class="line"><span class="comment">################################删除文件##############################################</span></span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-cn">
    <link itemprop="mainEntityOfPage" href="https://hongxing.tech/20240701oracle%E7%B3%BB%E7%BB%9F%E9%94%99%E8%AF%AF%E4%BF%AE%E5%A4%8D/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wanghongxing">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红星">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/20240701oracle%E7%B3%BB%E7%BB%9F%E9%94%99%E8%AF%AF%E4%BF%AE%E5%A4%8D/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-07-01 09:11:28" itemprop="dateCreated datePublished" datetime="2024-07-01T09:11:28+08:00">2024-07-01</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>oracle系统错误修复</p>
<p>某次重启服务器后，oracle提示：</p>
<p>ORA-01034: ORACLE not available<br>ORA-27101: shared memory realm does not exist<br>Linux-x86_64 Error: 2: No such file or directory</p>
<p>google查询知道 <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/6555827/ora-01034-oracle-not-available-ora-27101-shared-memory-realm-does-not-exist">https://stackoverflow.com/questions/6555827/ora-01034-oracle-not-available-ora-27101-shared-memory-realm-does-not-exist</a></p>
<p>Open command prompt and execute the below commands:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> oracle_sid<span class="operator">=</span>DATABASE NAME</span><br><span class="line">sqlplus <span class="operator">/</span>nolog</span><br><span class="line">conn sys<span class="operator">/</span>sys <span class="keyword">as</span> sysdba</span><br><span class="line">shutdown abort</span><br><span class="line">startup</span><br></pre></td></tr></table></figure>

<p>按照上面执行命令后，问题得以解决。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-cn">
    <link itemprop="mainEntityOfPage" href="https://hongxing.tech/20240625%E8%80%81%E7%9A%84%20asp.net%20%E9%A1%B9%E7%9B%AE%E4%B8%AD%E6%96%87%E4%BB%B6%20gb2312%20%E7%BC%96%E7%A0%81%E7%BB%9F%E4%B8%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wanghongxing">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红星">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/20240625%E8%80%81%E7%9A%84%20asp.net%20%E9%A1%B9%E7%9B%AE%E4%B8%AD%E6%96%87%E4%BB%B6%20gb2312%20%E7%BC%96%E7%A0%81%E7%BB%9F%E4%B8%80/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2024-06-25 10:02:04 / Modified: 14:01:35" itemprop="dateCreated datePublished" datetime="2024-06-25T10:02:04+08:00">2024-06-25</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>20240625老的 asp.net 项目中文件 gb2312 编码统一</p>
<p>传统windows下面的文件，很多老的项目中文件编码有gb2312的，也有unicode的，在vscode中修改的话经常会出错，因为写了个小脚本，把所有非unicode编码的文件统一改为unicode编码。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line">__author__ = <span class="string">&#x27;whx&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> os,sys</span><br><span class="line"><span class="keyword">import</span> chardet</span><br><span class="line"><span class="keyword">import</span> glob </span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convert</span>(<span class="params"> filename, in_enc = <span class="string">&quot;GBK&quot;</span>, out_enc=<span class="string">&quot;UTF-8-SIG&quot;</span> </span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        content = <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">        result = chardet.detect(content)<span class="comment">#通过chardet.detect获取当前文件的编码格式串，返回类型为字典类型</span></span><br><span class="line">        coding = result.get(<span class="string">&#x27;encoding&#x27;</span>)<span class="comment">#获取encoding的值[编码格式]</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;UTF&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> coding <span class="keyword">and</span> <span class="string">&quot;utf&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> coding :<span class="comment">#文件格式如果不是utf-8的时候，才进行转码</span></span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;转换 &quot;</span>+ coding + <span class="string">&quot;to utf-8! &quot;</span> + filename)</span><br><span class="line">            new_content = content.decode( coding ).encode(out_enc)</span><br><span class="line">            <span class="built_in">open</span>(filename, <span class="string">&#x27;wb&#x27;</span>).write( new_content )</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot; done&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;不用修改 &quot;</span>+coding + <span class="string">&quot;:&quot;</span> +filename)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> ex:</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot; error&quot;</span>,ex)</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">filesAspx = glob.glob(<span class="string">&quot;D:\source\project/**/*.aspx&quot;</span>,recursive=<span class="literal">True</span>)</span><br><span class="line">filesCs = glob.glob(<span class="string">&quot;D:\source\project/**/*.cs&quot;</span>,recursive=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> file_path <span class="keyword">in</span> filesAspx:</span><br><span class="line">   convert(file_path)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> file_path <span class="keyword">in</span> filesAspx:</span><br><span class="line">   convert(filesCs)</span><br><span class="line">    </span><br><span class="line">    </span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-cn">
    <link itemprop="mainEntityOfPage" href="https://hongxing.tech/20240625%E8%80%81%E7%9A%84web%E5%BA%94%E7%94%A8jquery%E4%B8%AD%E6%94%AF%E6%8C%81%E6%96%B0%E7%89%88%E6%9C%ACjquery/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wanghongxing">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红星">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/20240625%E8%80%81%E7%9A%84web%E5%BA%94%E7%94%A8jquery%E4%B8%AD%E6%94%AF%E6%8C%81%E6%96%B0%E7%89%88%E6%9C%ACjquery/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2024-06-25 09:26:41 / Modified: 14:01:37" itemprop="dateCreated datePublished" datetime="2024-06-25T09:26:41+08:00">2024-06-25</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>20240625老的web应用jquery中支持新版本jquery</p>
<p>老的项目中使用了1.6.x的jquery，需要升级其中的弹窗为layui，但是layui需要至少1.10.x，修改方式如下，将原来单行的jquery引用，改为保护多版本jquery，添加layui引用，最后恢复原来的jquery版本号，确保不影响原来其它jquery使用的地方。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=&quot;../js/jquery-1.3.2.min.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;</span><br><span class="line">  </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> &lt;script type=&quot;text/javascript&quot; src=&quot;../js/lib/jquery.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;../js/jquerynew.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;../js/layer/js/layer.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script  type=&quot;text/javascript&quot; &gt;var $jq = jQuery.noConflict(true);console.log($().jquery);&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>顺便做一个批量替换的脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="comment">#@Author: whx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> glob</span><br><span class="line"><span class="comment">#构建一个文本文件内容查找函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">replace_text</span>(<span class="params">file_path, search_str</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f ,<span class="built_in">open</span>(<span class="string">&quot;%s.bak&quot;</span>%file_path, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> fw:</span><br><span class="line">            data = f.read()</span><br><span class="line">            res = re.findall(search_str, data)</span><br><span class="line">            <span class="keyword">if</span> res :</span><br><span class="line">                newData = re.sub(search_str, <span class="string">r&#x27;&lt;script type=&quot;text/javascript&quot; src=&quot;\g&lt;2&gt;/jquery-\g&lt;3&gt;.js&quot;&gt;&lt;/script&gt;\n&lt;script type=&quot;text/javascript&quot; src=&quot;\g&lt;2&gt;/jquerynew.js&quot;&gt;&lt;/script&gt;\n&lt;script type=&quot;text/javascript&quot; src=&quot;\g&lt;2&gt;/layer.js&quot;&gt;&lt;/script&gt;\n&lt;script  type=&quot;text/javascript&quot; &gt;var $jq = jQuery.noConflict(true);console.log($().jquery);&lt;/script&gt;&#x27;</span> , data)</span><br><span class="line">                fw.write(newData)</span><br><span class="line">                f.close()</span><br><span class="line">                fw.close()</span><br><span class="line">                os.remove(file_path)</span><br><span class="line">                os.rename(<span class="string">&quot;%s.bak&quot;</span> % file_path, file_path)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                f.close()</span><br><span class="line">                fw.close()</span><br><span class="line">                os.remove(<span class="string">&quot;%s.bak&quot;</span> % file_path)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">except</span> UnicodeDecodeError:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;gbk&#x27;</span>) <span class="keyword">as</span> f ,<span class="built_in">open</span>(<span class="string">&quot;%s.bak&quot;</span>%file_path, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;gbk&#x27;</span>) <span class="keyword">as</span> fw:</span><br><span class="line">            data = f.read()</span><br><span class="line">            res = re.findall(search_str, data)</span><br><span class="line">            <span class="keyword">if</span> res :</span><br><span class="line">                newData = re.sub(search_str, <span class="string">r&#x27;&lt;script type=&quot;text/javascript&quot; src=&quot;\g&lt;2&gt;/jquery-\g&lt;3&gt;.js&quot;&gt;&lt;/script&gt;\n&lt;script type=&quot;text/javascript&quot; src=&quot;\g&lt;2&gt;/jquerynew.js&quot;&gt;&lt;/script&gt;\n&lt;script type=&quot;text/javascript&quot; src=&quot;\g&lt;2&gt;/layer.js&quot;&gt;&lt;/script&gt;\n&lt;script  type=&quot;text/javascript&quot; &gt;var $jq = jQuery.noConflict(true);console.log($().jquery);&lt;/script&gt;&#x27;</span> , data)</span><br><span class="line">                fw.write(newData)</span><br><span class="line">                f.close()</span><br><span class="line">                fw.close()</span><br><span class="line">                os.remove(file_path)</span><br><span class="line">                os.rename(<span class="string">&quot;%s.bak&quot;</span> % file_path, file_path)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                f.close()</span><br><span class="line">                fw.close()</span><br><span class="line">                os.remove(<span class="string">&quot;%s.bak&quot;</span> % file_path)</span><br><span class="line">files = glob.glob(<span class="string">&quot;D:\source\project/**/*.aspx*&quot;</span>,recursive=<span class="literal">True</span>)</span><br><span class="line">search_str = <span class="string">&quot;&lt;script(.*)src=\&quot;(.*)/jquery-(.*).js\&quot;(.*)&gt;(.*)&lt;/script&gt;&quot;</span></span><br><span class="line">search_str_reg = re.<span class="built_in">compile</span>(search_str,flags=re.IGNORECASE)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> file_path <span class="keyword">in</span> files:</span><br><span class="line">   replace_text(file_path, search_str_reg )</span><br><span class="line">  </span><br><span class="line"></span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-cn">
    <link itemprop="mainEntityOfPage" href="https://hongxing.tech/20240603-s3%20minio%E5%AD%A6%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wanghongxing">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红星">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/20240603-s3%20minio%E5%AD%A6%E4%B9%A0/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-06-03 09:23:17" itemprop="dateCreated datePublished" datetime="2024-06-03T09:23:17+08:00">2024-06-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-06-04 08:56:52" itemprop="dateModified" datetime="2024-06-04T08:56:52+08:00">2024-06-04</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>s3 minio学习</p>
<p>直接采用docker方式运行,docker-compose.yml</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">minio:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">minio/minio</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;9000:9000&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;9001:9001&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./data:/data</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./config:/root/.minio</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">MINIO_ROOT_USER:</span> <span class="string">whx</span></span><br><span class="line">      <span class="attr">MINIO_ROOT_PASSWORD:</span> <span class="string">Whxheart0210</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">server</span> <span class="string">--console-address</span> <span class="string">&quot;:9001&quot;</span> <span class="string">/data</span></span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<p>然后nginx做反向代理</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line"></span><br><span class="line">       listen 80;</span><br><span class="line">       server_name                     s3.haowujidian.com;</span><br><span class="line">       client_max_body_size        20M;</span><br><span class="line"></span><br><span class="line">        root                            /data/www/s3.haowujidian.com;</span><br><span class="line">        error_page                      403     404      /404.php;</span><br><span class="line">        index                           index.html index.htm  index.php;</span><br><span class="line">        try_files $uri /index.html;</span><br><span class="line">        error_log                       /var/log/nginx/nginx-error.s3.log;</span><br><span class="line">        access_log                      /var/log/nginx/nginx-access.s3.log;</span><br><span class="line">        charset &quot;utf-8&quot;;</span><br><span class="line">        add_header X-Content-Type-Options nosniff;</span><br><span class="line">        add_header Content-Security-Policy &quot;default-src &#x27;self&#x27; &#x27;unsafe-inline&#x27; data:;script-src &#x27;self&#x27; &#x27;unsafe-inline&#x27; &#x27;unsafe-eval&#x27;; object-src &#x27;none&#x27;;style-src &#x27;self&#x27; &#x27;unsafe-inline&#x27;; child-src https:&quot;;</span><br><span class="line">        add_header X-XSS-Protection &quot;1; mode=block&quot;;</span><br><span class="line">        add_header Strict-Transport-Security &quot;max-age=31536000&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">                charset &quot;utf8&quot;;</span><br><span class="line">                            proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class="line">                proxy_set_header    Host            $http_host;</span><br><span class="line">                proxy_set_header    X-Real-IP       $remote_addr;</span><br><span class="line">                proxy_set_header    X-Forwarded-for $remote_addr;</span><br><span class="line">                proxy_connect_timeout 10000;</span><br><span class="line">                proxy_read_timeout 10000;</span><br><span class="line">                keepalive_timeout  6000;</span><br><span class="line">                #port_in_redirect off;</span><br><span class="line">                proxy_pass http://127.0.0.1:9000;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line"></span><br><span class="line">       listen 80;</span><br><span class="line">       server_name                     s3-console.haowujidian.com;</span><br><span class="line">        client_max_body_size            20M;</span><br><span class="line"></span><br><span class="line">        root                            /data/www/s3.haowujidian.com;</span><br><span class="line">        error_page                      403     404      /404.php;</span><br><span class="line">        index                           index.html index.htm  index.php;</span><br><span class="line">        try_files $uri /index.html;</span><br><span class="line">        error_log                       /var/log/nginx/nginx-error.s3.log;</span><br><span class="line">        access_log                      /var/log/nginx/nginx-access.s3.log;</span><br><span class="line">        charset &quot;utf-8&quot;;</span><br><span class="line">        add_header X-Content-Type-Options nosniff;</span><br><span class="line">        add_header Content-Security-Policy &quot;default-src &#x27;self&#x27; &#x27;unsafe-inline&#x27; data:;script-src &#x27;self&#x27; &#x27;unsafe-inline&#x27; &#x27;unsafe-eval&#x27;; object-src &#x27;none&#x27;;style-src &#x27;self&#x27; &#x27;unsafe-inline&#x27;; child-src https:&quot;;</span><br><span class="line">        add_header X-XSS-Protection &quot;1; mode=block&quot;;</span><br><span class="line">        add_header Strict-Transport-Security &quot;max-age=31536000&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">                charset &quot;utf8&quot;;</span><br><span class="line">                            proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class="line">                proxy_set_header    Host            $http_host;</span><br><span class="line">                proxy_set_header    X-Real-IP       $remote_addr;</span><br><span class="line">                proxy_set_header    X-Forwarded-for $remote_addr;</span><br><span class="line">                proxy_connect_timeout 10000;</span><br><span class="line">                proxy_read_timeout 10000;</span><br><span class="line">                keepalive_timeout  6000;</span><br><span class="line">                #port_in_redirect off;</span><br><span class="line">                proxy_pass http://127.0.0.1:9001;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>客户端学习</p>
<p>下载mc客户端</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl --progress-bar -O https://dl.min.io/client/mc/release/darwin-arm64/mc </span><br><span class="line">chmod +x mc</span><br><span class="line"></span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">wanghongxing</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">59</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">wanghongxing</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
