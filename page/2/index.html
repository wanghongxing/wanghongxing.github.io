<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"hongxing.tech","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="红星的个人主页">
<meta property="og:url" content="https://hongxing.tech/page/2/index.html">
<meta property="og:site_name" content="红星的个人主页">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="wanghongxing">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://hongxing.tech/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-cn'
  };
</script>

  <title>红星的个人主页</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">红星的个人主页</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>Commonweal 404</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-cn">
    <link itemprop="mainEntityOfPage" href="https://hongxing.tech/20240625%E8%80%81%E7%9A%84%20asp.net%20%E9%A1%B9%E7%9B%AE%E4%B8%AD%E6%96%87%E4%BB%B6%20gb2312%20%E7%BC%96%E7%A0%81%E7%BB%9F%E4%B8%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wanghongxing">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红星的个人主页">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/20240625%E8%80%81%E7%9A%84%20asp.net%20%E9%A1%B9%E7%9B%AE%E4%B8%AD%E6%96%87%E4%BB%B6%20gb2312%20%E7%BC%96%E7%A0%81%E7%BB%9F%E4%B8%80/" class="post-title-link" itemprop="url">20240625老的 asp.net 项目中文件 gb2312 编码统一</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-06-25 10:02:04" itemprop="dateCreated datePublished" datetime="2024-06-25T10:02:04+08:00">2024-06-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-02-27 14:15:31" itemprop="dateModified" datetime="2025-02-27T14:15:31+08:00">2025-02-27</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>传统windows下面的文件，很多老的项目中文件编码有gb2312的，也有unicode的，在vscode中修改的话经常会出错，因为写了个小脚本，把所有非unicode编码的文件统一改为unicode编码。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line">__author__ = <span class="string">&#x27;whx&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> os,sys</span><br><span class="line"><span class="keyword">import</span> chardet</span><br><span class="line"><span class="keyword">import</span> glob </span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convert</span>(<span class="params"> filename, in_enc = <span class="string">&quot;GBK&quot;</span>, out_enc=<span class="string">&quot;UTF-8-SIG&quot;</span> </span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        content = <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">        result = chardet.detect(content)<span class="comment">#通过chardet.detect获取当前文件的编码格式串，返回类型为字典类型</span></span><br><span class="line">        coding = result.get(<span class="string">&#x27;encoding&#x27;</span>)<span class="comment">#获取encoding的值[编码格式]</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;UTF&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> coding <span class="keyword">and</span> <span class="string">&quot;utf&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> coding :<span class="comment">#文件格式如果不是utf-8的时候，才进行转码</span></span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;转换 &quot;</span>+ coding + <span class="string">&quot;to utf-8! &quot;</span> + filename)</span><br><span class="line">            new_content = content.decode( coding ).encode(out_enc)</span><br><span class="line">            <span class="built_in">open</span>(filename, <span class="string">&#x27;wb&#x27;</span>).write( new_content )</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot; done&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;不用修改 &quot;</span>+coding + <span class="string">&quot;:&quot;</span> +filename)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> ex:</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot; error&quot;</span>,ex)</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">filesAspx = glob.glob(<span class="string">&quot;D:\source\project/**/*.aspx&quot;</span>,recursive=<span class="literal">True</span>)</span><br><span class="line">filesCs = glob.glob(<span class="string">&quot;D:\source\project/**/*.cs&quot;</span>,recursive=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> file_path <span class="keyword">in</span> filesAspx:</span><br><span class="line">   convert(file_path)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> file_path <span class="keyword">in</span> filesAspx:</span><br><span class="line">   convert(filesCs)</span><br><span class="line">    </span><br><span class="line">    </span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-cn">
    <link itemprop="mainEntityOfPage" href="https://hongxing.tech/20240625%E8%80%81%E7%9A%84web%E5%BA%94%E7%94%A8jquery%E4%B8%AD%E6%94%AF%E6%8C%81%E6%96%B0%E7%89%88%E6%9C%ACjquery/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wanghongxing">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红星的个人主页">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/20240625%E8%80%81%E7%9A%84web%E5%BA%94%E7%94%A8jquery%E4%B8%AD%E6%94%AF%E6%8C%81%E6%96%B0%E7%89%88%E6%9C%ACjquery/" class="post-title-link" itemprop="url">20240625老的web应用jquery中支持新版本jquery</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-06-25 09:26:41" itemprop="dateCreated datePublished" datetime="2024-06-25T09:26:41+08:00">2024-06-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-02-27 14:15:18" itemprop="dateModified" datetime="2025-02-27T14:15:18+08:00">2025-02-27</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>老的项目中使用了1.6.x的jquery，需要升级其中的弹窗为layui，但是layui需要至少1.10.x，修改方式如下，将原来单行的jquery引用，改为保护多版本jquery，添加layui引用，最后恢复原来的jquery版本号，确保不影响原来其它jquery使用的地方。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=&quot;../js/jquery-1.3.2.min.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;</span><br><span class="line">  </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> &lt;script type=&quot;text/javascript&quot; src=&quot;../js/lib/jquery.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;../js/jquerynew.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;../js/layer/js/layer.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script  type=&quot;text/javascript&quot; &gt;var $jq = jQuery.noConflict(true);console.log($().jquery);&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>顺便做一个批量替换的脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="comment">#@Author: whx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> glob</span><br><span class="line"><span class="comment">#构建一个文本文件内容查找函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">replace_text</span>(<span class="params">file_path, search_str</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f ,<span class="built_in">open</span>(<span class="string">&quot;%s.bak&quot;</span>%file_path, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> fw:</span><br><span class="line">            data = f.read()</span><br><span class="line">            res = re.findall(search_str, data)</span><br><span class="line">            <span class="keyword">if</span> res :</span><br><span class="line">                newData = re.sub(search_str, <span class="string">r&#x27;&lt;script type=&quot;text/javascript&quot; src=&quot;\g&lt;2&gt;/jquery-\g&lt;3&gt;.js&quot;&gt;&lt;/script&gt;\n&lt;script type=&quot;text/javascript&quot; src=&quot;\g&lt;2&gt;/jquerynew.js&quot;&gt;&lt;/script&gt;\n&lt;script type=&quot;text/javascript&quot; src=&quot;\g&lt;2&gt;/layer.js&quot;&gt;&lt;/script&gt;\n&lt;script  type=&quot;text/javascript&quot; &gt;var $jq = jQuery.noConflict(true);console.log($().jquery);&lt;/script&gt;&#x27;</span> , data)</span><br><span class="line">                fw.write(newData)</span><br><span class="line">                f.close()</span><br><span class="line">                fw.close()</span><br><span class="line">                os.remove(file_path)</span><br><span class="line">                os.rename(<span class="string">&quot;%s.bak&quot;</span> % file_path, file_path)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                f.close()</span><br><span class="line">                fw.close()</span><br><span class="line">                os.remove(<span class="string">&quot;%s.bak&quot;</span> % file_path)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">except</span> UnicodeDecodeError:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;gbk&#x27;</span>) <span class="keyword">as</span> f ,<span class="built_in">open</span>(<span class="string">&quot;%s.bak&quot;</span>%file_path, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;gbk&#x27;</span>) <span class="keyword">as</span> fw:</span><br><span class="line">            data = f.read()</span><br><span class="line">            res = re.findall(search_str, data)</span><br><span class="line">            <span class="keyword">if</span> res :</span><br><span class="line">                newData = re.sub(search_str, <span class="string">r&#x27;&lt;script type=&quot;text/javascript&quot; src=&quot;\g&lt;2&gt;/jquery-\g&lt;3&gt;.js&quot;&gt;&lt;/script&gt;\n&lt;script type=&quot;text/javascript&quot; src=&quot;\g&lt;2&gt;/jquerynew.js&quot;&gt;&lt;/script&gt;\n&lt;script type=&quot;text/javascript&quot; src=&quot;\g&lt;2&gt;/layer.js&quot;&gt;&lt;/script&gt;\n&lt;script  type=&quot;text/javascript&quot; &gt;var $jq = jQuery.noConflict(true);console.log($().jquery);&lt;/script&gt;&#x27;</span> , data)</span><br><span class="line">                fw.write(newData)</span><br><span class="line">                f.close()</span><br><span class="line">                fw.close()</span><br><span class="line">                os.remove(file_path)</span><br><span class="line">                os.rename(<span class="string">&quot;%s.bak&quot;</span> % file_path, file_path)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                f.close()</span><br><span class="line">                fw.close()</span><br><span class="line">                os.remove(<span class="string">&quot;%s.bak&quot;</span> % file_path)</span><br><span class="line">files = glob.glob(<span class="string">&quot;D:\source\project/**/*.aspx*&quot;</span>,recursive=<span class="literal">True</span>)</span><br><span class="line">search_str = <span class="string">&quot;&lt;script(.*)src=\&quot;(.*)/jquery-(.*).js\&quot;(.*)&gt;(.*)&lt;/script&gt;&quot;</span></span><br><span class="line">search_str_reg = re.<span class="built_in">compile</span>(search_str,flags=re.IGNORECASE)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> file_path <span class="keyword">in</span> files:</span><br><span class="line">   replace_text(file_path, search_str_reg )</span><br><span class="line">  </span><br><span class="line"></span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-cn">
    <link itemprop="mainEntityOfPage" href="https://hongxing.tech/20240603-s3%20minio%E5%AD%A6%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wanghongxing">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红星的个人主页">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/20240603-s3%20minio%E5%AD%A6%E4%B9%A0/" class="post-title-link" itemprop="url">s3 minio学习</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-06-03 09:23:17" itemprop="dateCreated datePublished" datetime="2024-06-03T09:23:17+08:00">2024-06-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-03-31 11:26:57" itemprop="dateModified" datetime="2025-03-31T11:26:57+08:00">2025-03-31</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>s3 minio学习</p>
<p>直接采用docker方式运行,docker-compose.yml</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">minio:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">minio/minio</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;9000:9000&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;9001:9001&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./data:/data</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./config:/root/.minio</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">MINIO_ROOT_USER:</span> <span class="string">whx</span></span><br><span class="line">      <span class="attr">MINIO_ROOT_PASSWORD:</span> <span class="string">IamPasswod</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">server</span> <span class="string">--console-address</span> <span class="string">&quot;:9001&quot;</span> <span class="string">/data</span></span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<p>然后nginx做反向代理</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line"></span><br><span class="line">       listen 80;</span><br><span class="line">       server_name                     s3.wanghongxing.com;</span><br><span class="line">       client_max_body_size        20M;</span><br><span class="line"></span><br><span class="line">        root                            /data/www/s3.wanghongxing.com;</span><br><span class="line">        error_page                      403     404      /404.php;</span><br><span class="line">        index                           index.html index.htm  index.php;</span><br><span class="line">        try_files $uri /index.html;</span><br><span class="line">        error_log                       /var/log/nginx/nginx-error.s3.log;</span><br><span class="line">        access_log                      /var/log/nginx/nginx-access.s3.log;</span><br><span class="line">        charset &quot;utf-8&quot;;</span><br><span class="line">        add_header X-Content-Type-Options nosniff;</span><br><span class="line">        add_header Content-Security-Policy &quot;default-src &#x27;self&#x27; &#x27;unsafe-inline&#x27; data:;script-src &#x27;self&#x27; &#x27;unsafe-inline&#x27; &#x27;unsafe-eval&#x27;; object-src &#x27;none&#x27;;style-src &#x27;self&#x27; &#x27;unsafe-inline&#x27;; child-src https:&quot;;</span><br><span class="line">        add_header X-XSS-Protection &quot;1; mode=block&quot;;</span><br><span class="line">        add_header Strict-Transport-Security &quot;max-age=31536000&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">                charset &quot;utf8&quot;;</span><br><span class="line">                            proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class="line">                proxy_set_header    Host            $http_host;</span><br><span class="line">                proxy_set_header    X-Real-IP       $remote_addr;</span><br><span class="line">                proxy_set_header    X-Forwarded-for $remote_addr;</span><br><span class="line">                proxy_connect_timeout 10000;</span><br><span class="line">                proxy_read_timeout 10000;</span><br><span class="line">                keepalive_timeout  6000;</span><br><span class="line">                #port_in_redirect off;</span><br><span class="line">                proxy_pass http://127.0.0.1:9000;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line"></span><br><span class="line">       listen 80;</span><br><span class="line">       server_name                     s3-console.wanghongxing.com;</span><br><span class="line">        client_max_body_size            20M;</span><br><span class="line"></span><br><span class="line">        root                            /data/www/s3.wanghongxing.com;</span><br><span class="line">        error_page                      403     404      /404.php;</span><br><span class="line">        index                           index.html index.htm  index.php;</span><br><span class="line">        try_files $uri /index.html;</span><br><span class="line">        error_log                       /var/log/nginx/nginx-error.s3.log;</span><br><span class="line">        access_log                      /var/log/nginx/nginx-access.s3.log;</span><br><span class="line">        charset &quot;utf-8&quot;;</span><br><span class="line">        add_header X-Content-Type-Options nosniff;</span><br><span class="line">        add_header Content-Security-Policy &quot;default-src &#x27;self&#x27; &#x27;unsafe-inline&#x27; data:;script-src &#x27;self&#x27; &#x27;unsafe-inline&#x27; &#x27;unsafe-eval&#x27;; object-src &#x27;none&#x27;;style-src &#x27;self&#x27; &#x27;unsafe-inline&#x27;; child-src https:&quot;;</span><br><span class="line">        add_header X-XSS-Protection &quot;1; mode=block&quot;;</span><br><span class="line">        add_header Strict-Transport-Security &quot;max-age=31536000&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">                charset &quot;utf8&quot;;</span><br><span class="line">                            proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class="line">                proxy_set_header    Host            $http_host;</span><br><span class="line">                proxy_set_header    X-Real-IP       $remote_addr;</span><br><span class="line">                proxy_set_header    X-Forwarded-for $remote_addr;</span><br><span class="line">                proxy_connect_timeout 10000;</span><br><span class="line">                proxy_read_timeout 10000;</span><br><span class="line">                keepalive_timeout  6000;</span><br><span class="line">                #port_in_redirect off;</span><br><span class="line">                proxy_pass http://127.0.0.1:9001;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>客户端学习</p>
<p>下载mc客户端</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl --progress-bar -O https://dl.min.io/client/mc/release/darwin-arm64/mc </span><br><span class="line">chmod +x mc</span><br><span class="line"></span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-cn">
    <link itemprop="mainEntityOfPage" href="https://hongxing.tech/2024-5-20-macos%20m1miniconda%E4%BD%BF%E7%94%A8python2.7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wanghongxing">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红星的个人主页">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024-5-20-macos%20m1miniconda%E4%BD%BF%E7%94%A8python2.7/" class="post-title-link" itemprop="url">Untitled</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-05-21 11:00:39" itemprop="dateCreated datePublished" datetime="2024-05-21T11:00:39+08:00">2024-05-21</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>macos m1miniconda使用python2.7</p>
<p>conda create -n python27 python=2.7 anaconda</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CONDA_SUBDIR=osx-64 conda create -n py27 python=2.7</span><br></pre></td></tr></table></figure>



      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-cn">
    <link itemprop="mainEntityOfPage" href="https://hongxing.tech/20240521-%E6%89%8B%E5%8A%A8%E7%94%B3%E8%AF%B7letsencrypt%E8%AF%81%E4%B9%A6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wanghongxing">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红星的个人主页">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/20240521-%E6%89%8B%E5%8A%A8%E7%94%B3%E8%AF%B7letsencrypt%E8%AF%81%E4%B9%A6/" class="post-title-link" itemprop="url">手动申请letsencrypt证书</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-05-21 09:41:19" itemprop="dateCreated datePublished" datetime="2024-05-21T09:41:19+08:00">2024-05-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-02-27 14:14:14" itemprop="dateModified" datetime="2025-02-27T14:14:14+08:00">2025-02-27</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>系统安装docker，然后在执行如下命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --rm --name certbot \</span><br><span class="line">           -v &quot;/etc/letsencrypt:/etc/letsencrypt&quot; \</span><br><span class="line">           -v &quot;/var/lib/www:/www&quot; \</span><br><span class="line">           certbot/certbot certonly</span><br></pre></td></tr></table></figure>

<p>其中/var/lib/www是域名静态根目录，期间提示号域名的根目录的时候输入 /www</p>
<p>正常的话会将证书放到/etc/letsencrypt目录下。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-cn">
    <link itemprop="mainEntityOfPage" href="https://hongxing.tech/20240422-macbook-silicon-%E8%BF%90%E8%A1%8Ckettle%EF%BC%88data-integration%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wanghongxing">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红星的个人主页">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/20240422-macbook-silicon-%E8%BF%90%E8%A1%8Ckettle%EF%BC%88data-integration%EF%BC%89/" class="post-title-link" itemprop="url">macbook (silicon) 运行kettle（data-integration）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2024-04-22 08:16:30 / Modified: 08:25:45" itemprop="dateCreated datePublished" datetime="2024-04-22T08:16:30+08:00">2024-04-22</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>macbook   silicon 运行kettle（data-integration）</p>
<p>kettle在windows及intel电脑运行正常，但是在silicon芯片的macos上执行是提示：不支持arm64。搜索 发现解决方案： <a target="_blank" rel="noopener" href="https://medium.com/@gabriella.mayang/how-to-install-and-open-pentaho-data-integration-on-macbook-m2-apple-silicon-4081c2875a02">https://medium.com/@gabriella.mayang/how-to-install-and-open-pentaho-data-integration-on-macbook-m2-apple-silicon-4081c2875a02</a></p>
<h1 id="Step-1-Download-JDK-and-JRE"><a href="#Step-1-Download-JDK-and-JRE" class="headerlink" title="Step 1: Download JDK and JRE"></a>Step 1: Download JDK and JRE</h1><p>I tried JDK from Oracle but it failed. Now the only JDK that I am using and proven successful in opening PDI in my M2 is the one from <strong>Eclipse Temurin OpenJDK.</strong></p>
<ol>
<li>Click here to download <a target="_blank" rel="noopener" href="https://adoptium.net/temurin/releases/?variant=openjdk8&amp;os=mac">https://adoptium.net/temurin/releases/?variant=openjdk8&amp;os=mac</a></li>
<li>Choose JDK .pkg</li>
</ol>
<h1 id="Step-2-Download-MacOSX-X86-JAR"><a href="#Step-2-Download-MacOSX-X86-JAR" class="headerlink" title="Step 2: Download MacOSX X86 JAR"></a>Step 2: Download MacOSX X86 JAR</h1><ol>
<li>Click here to download <a target="_blank" rel="noopener" href="https://mega.nz/file/VFhgnS6I#s4zUK81rXGdXcpJMuzUvDOHoixZmAl4jyXd0yMU11F0">https://mega.nz/file/VFhgnS6I#s4zUK81rXGdXcpJMuzUvDOHoixZmAl4jyXd0yMU11F0</a></li>
<li>Move the file to ‘libswt/osx64’</li>
</ol>
<p>就是把下载的文件放到 data-integration/libswt/osx64 目录下。</p>
<h1 id="Step-4-Create-New-Terminal-Profile-for-Intel"><a href="#Step-4-Create-New-Terminal-Profile-for-Intel" class="headerlink" title="Step 4: Create New Terminal Profile for Intel"></a>Step 4: Create New Terminal Profile for Intel</h1><p>注：这里是苹果原生的terminal，不是iterm。</p>
<ol>
<li>Open Terminal &gt; Settings</li>
<li>Click the ‘**+’** button to add new profile and name it as “Rosetta Intel”. You can choose another name but make sure the new profile name indicates the profile usage is for Intel-based apps</li>
<li>Go to ‘Shell’ tab and paste this in the ‘Run Command’ field:</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">env /usr/bin/arch -x86_64 /bin/zsh --login</span><br></pre></td></tr></table></figure>

<p>Uncheck ‘Run inside shell’. Uncheck the checkbox would prevent running the shell twice, which could bloat your environment variables since ~/.zshrc gets run twice</p>
<h3 id="最后-JAVA-HOME"><a href="#最后-JAVA-HOME" class="headerlink" title="最后 JAVA_HOME"></a>最后 JAVA_HOME</h3><p>因为我用了多版本的jdk，所以需要单独设置一个java环境</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/Library/Java/JavaVirtualMachines/temurin-8.jdk/Contents/Home</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后就成功了。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-cn">
    <link itemprop="mainEntityOfPage" href="https://hongxing.tech/20240304-%E8%A7%A3%E5%86%B3%20%E8%AE%BF%E9%97%AEhttp%E8%87%AA%E5%8A%A8%E8%B7%B3%E8%BD%AC%E5%88%B0https%E7%9A%84%E9%97%AE%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wanghongxing">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红星的个人主页">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/20240304-%E8%A7%A3%E5%86%B3%20%E8%AE%BF%E9%97%AEhttp%E8%87%AA%E5%8A%A8%E8%B7%B3%E8%BD%AC%E5%88%B0https%E7%9A%84%E9%97%AE%E9%A2%98/" class="post-title-link" itemprop="url">20240304-解决 访问http自动跳转到https的问题</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2024-03-04 09:20:34 / Modified: 09:58:33" itemprop="dateCreated datePublished" datetime="2024-03-04T09:20:34+08:00">2024-03-04</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>解决 访问http自动跳转到https的问题</p>
<p>1、先访问http域名，然后点击地址栏所测那个“不安全”的警告，弹出对话框中选择网站设置，</p>
<p><img src="../images/2024-03-04-09.37.38.png" alt="2024-03-04-09.37.38"></p>
<p>2、然后再下面的不安全内容后面的下拉框中选择<strong>允许</strong></p>
<p><img src="../images/2024-03-04-09.37.47.png" alt="2024-03-04-09.37.47"></p>
<p>3、在地址栏输入: chrome://net-internals/#hsts</p>
<img src="../images/截屏2024-03-04 09.53.37.png" alt="截屏2024-03-04 09.53.37" style="zoom: 67%;" />

<p>4、找到底部Delete domain security policies一栏，输入想处理的域名，点击delete。</p>
<img src="../images/截屏2024-03-04 09.53.51.png" alt="截屏2024-03-04 09.53.51" style="zoom:67%;" />

<p>5、搞定了，再次访问http域名不再自动跳转https了。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-cn">
    <link itemprop="mainEntityOfPage" href="https://hongxing.tech/20240226-pytorch%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wanghongxing">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红星的个人主页">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/20240226-pytorch%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/" class="post-title-link" itemprop="url">20240226pytorch学习之路</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-02-26 09:20:34" itemprop="dateCreated datePublished" datetime="2024-02-26T09:20:34+08:00">2024-02-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-03-04 10:07:02" itemprop="dateModified" datetime="2024-03-04T10:07:02+08:00">2024-03-04</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>pytorch学习之路</p>
<p>pytorch包含以下组件</p>
<p>torch: 一个像numpy 向量库</p>
<p>torch.autograd 自动微分库，支持所有微分向量运算</p>
<p>torch.jit 一个编译栈，从pytorch代码来创建可序列化、可以优化的模型</p>
<p>torch.nn 神经元网络库，设计之初保持了最大化灵活性，深度继承了求导库</p>
<p>torch.multiprocessing 多处理，在torch 向量访问处理器时使用了魔术化的内存共享。在数据加载和疯狂的训练模型的时候非常有用。</p>
<p>torch。utils 数据记在和其他功能</p>
<p>通常pytorch用作两个方面：</p>
<p>1、替代numpy来使用gpu</p>
<p>2、提供最大灵活性和速度的深度学习研究平台</p>
<p>动态神经元网络：使用磁带记录仪回放这种独特的方法来创建神经元网络。</p>
<p>pytorch使用反向模式自动微分技术，让我们经常零成本的改变网络行为；我们的灵感来自于这篇文章的几个研究报告。</p>
<p>这个技术不是pytorch独有的。这是目前为止最快速的实现。你可以为你疯狂的研究获得最快的速度和灵活性。</p>
<p>pytorch不是一个整体绑定到 c++框架的。他是深度集成到python中。你可以像使用numpy scipy scikit-learn一样自然的使用它。你可以写你自己全新神经元网络，使用你喜欢的库和包。我们的目标是不重复造轮子。</p>
<p>必要的经验</p>
<p>pytorch设计为只觉得、线性的思考、简单易用。当你执行一行代码，他被执行了。在现实世界中他不是异步视图。当你调试一行代码或者接收到错误信息和堆栈跟踪，理解他们是很直观的。堆栈调用之初你的代码在哪里被定义。我们希望你不要因为坏的堆栈调用、异步执行和不透明的执行引擎而花费时间调试你的代码。</p>
<p>快速和学习</p>
<p>pytorch有最小的框架成本。我们继承了加速库像intel MKL 和nvidia（cuDNN nccl)去最大化速度。最核心的，他核心的cpu gpu向量和神经元网络是成熟的并且经过多年测试的。</p>
<p>因此，pytorch是非常快的，无论执行小规模还是大规模的模型。</p>
<p>无痛扩展</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>二进制，命令行通过conda 或者pip 安装 参照： <a target="_blank" rel="noopener" href="https://pytorch.org/get-started/locally/">https://pytorch.org/get-started/locally/</a></p>
<p>源代码安装</p>
<p>需要满足：python 3.8+；编译器全面支持C++17，像clang或者gcc（gcc 9.4.0或者最新）</p>
<p>强烈推荐安装conda环境。</p>
<p>如果想要编译cuda支持，从我们的支持矩阵里选择一个我们支持的版本<a target="_blank" rel="noopener" href="https://pytorch.org/get-started/locally/">select a supported version of CUDA from our support matrix</a>。然后安装nvidia cuda ,nvidia cuDNN v8.5 + ,CUDA兼容的编译器。</p>
<p>如果要禁用CUDA，设置环境变量 USE_CUDA=0 .其它有用的环境变量在setup.py中。</p>
<h4 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h4><h4 id="Get-the-PyTorch-Source"><a href="#Get-the-PyTorch-Source" class="headerlink" title="Get the PyTorch Source"></a>Get the PyTorch Source</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git clone --recursive https://github.com/pytorch/pytorch</span><br><span class="line">cd pytorch</span><br><span class="line"># if you are updating an existing checkout</span><br><span class="line">git submodule sync</span><br><span class="line">git submodule update --init --recursive</span><br></pre></td></tr></table></figure>



<p>通用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">conda install cmake ninja</span><br><span class="line"># Run this command from the PyTorch directory after cloning the source code using the “Get the PyTorch Source“ section below</span><br><span class="line">pip install -r requirements.txt</span><br></pre></td></tr></table></figure>

<p><strong>On Linux</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">conda install intel::mkl-static intel::mkl-include</span><br><span class="line"># CUDA only: Add LAPACK support for the GPU if needed</span><br><span class="line">conda install -c pytorch magma-cuda110  # or the magma-cuda* that matches your CUDA version from https://anaconda.org/pytorch/repo</span><br><span class="line"></span><br><span class="line"># (optional) If using torch.compile with inductor/triton, install the matching version of triton</span><br><span class="line"># Run from the pytorch directory after cloning</span><br><span class="line">make triton</span><br></pre></td></tr></table></figure>

<p><strong>On MacOS</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Add this package on intel x86 processor machines only</span><br><span class="line">conda install intel::mkl-static intel::mkl-include</span><br><span class="line"># Add these packages if torch.distributed is needed</span><br><span class="line">conda install pkg-config libuv</span><br></pre></td></tr></table></figure>

<p><strong>On Windows</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">conda install intel::mkl-static intel::mkl-include</span><br><span class="line"># Add these packages if torch.distributed is needed.</span><br><span class="line"># Distributed package support on Windows is a prototype feature and is subject to changes.</span><br><span class="line">conda install -c conda-forge libuv=1.39</span><br></pre></td></tr></table></figure>



<h4 id="Install-PyTorch"><a href="#Install-PyTorch" class="headerlink" title="Install PyTorch"></a>Install PyTorch</h4><p><strong>On macOS</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 setup.py develop</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-cn">
    <link itemprop="mainEntityOfPage" href="https://hongxing.tech/20240219-sd%E6%A8%A1%E5%9E%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wanghongxing">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红星的个人主页">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/20240219-sd%E6%A8%A1%E5%9E%8B/" class="post-title-link" itemprop="url">20240219-sd模型</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-02-19 00:00:00" itemprop="dateCreated datePublished" datetime="2024-02-19T00:00:00+08:00">2024-02-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-03-04 09:59:24" itemprop="dateModified" datetime="2024-03-04T09:59:24+08:00">2024-03-04</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>20240219-sd模型</p>
<p>常见的模型有以下几类：</p>
<ul>
<li><strong>Base 模型：</strong> 就是最常见的 AI 文生图模型，输入一段文字指令，AI 会根据你的指令生成图片。较常见的有 Stable Diffusion v1.5，Stable Diffusion XL 等。</li>
<li><strong>LoRA 模型：</strong> 你可以简单将其理解为一种滤镜模型。通过它能生成更特殊的图片，比如在 Workflow 中加载线稿 LoRA 模型，就可以生成线稿风格的图片。甚至还有一些 LoRA 模型能让 AI 生成特定样貌的人物，比如一些名人的 LoRA，加载这种模型后，就可以生成特定的名人。但需要注意，这种模型没法脱离 Base 模型使用，这就意味着你需要先下载 Base 模型，然后再下载对应的 LoRA 模型才行。</li>
<li><strong>Inpainting 模型：</strong> 如果你想要修改某张图片，比如去掉某个物体，或者修复某个物体，那么你就需要使用 Inpainting 模型。这种模型输入一张图片，然后输入一个遮罩，AI 会根据遮罩修复图片。这个模型可以单独使用。</li>
<li><strong>Upscale 模型：</strong> 如果你想将一张图片放大，那么你就需要使用 Upscale 模型。这种模型输入一张图片，然后输入一个倍数，AI 会根据倍数放大图片。这个模型也可以单独使用。</li>
<li><strong>ControlNet 模型：</strong> 如果你想控制图片中某个物体出现的位置，或者人物的站姿，那么你就需要使用 ControlNet 模型。但需要注意这个模型和 LoRA 类似，不能脱离 Base 模型使用。</li>
<li><strong>图生视频模型：</strong> 这种模型输入一段文字指令，AI 会根据你的指令将图片转为视频。</li>
</ul>
<p>AI 生图模型需要大量的计算资源，如果你的电脑配置不够，那么即使你下载了模型，也可能无法运行，或者运行起来会很慢，生成一张图片可能要 30 ～ 40 秒。按照前面提到的类型，不同类型的模型对电脑配置的要求也不同。</p>
<p>对配置影响最大的应该是 Base、Inpainting 还有图生视频模型。目前，市面上没有一个官方统一的 AI 模型运行配置要求，但根据我的经验：</p>
<ul>
<li>Base &amp; Inpainting 模型：<ul>
<li>如果你是 Windows 电脑，显存小于 6G，或者是 M 系列的 MacBook 内存小于 16G，我会推荐你使用 Stable Diffusion v1.5 或者基于此模型微调后的模型。</li>
<li>如果你的电脑配置比较好，显存大于 8G，或者 M 系列的 MacBook 内存大于 16G，我则会推荐你使用 Stable Diffusion XL 或者基于此模型微调后的模型。</li>
</ul>
</li>
<li>如果你想使用图生视频模型，或者图片生视频模型，那么你的显存最好大于 16G，且最好使用 Nvidia 的显卡。不然基本很难将模型运行起来。</li>
</ul>
<p>如果你是初学者，我会推荐你使用 DreamShaper 这个模型，它有基于 SDv1.5 的 Base 模型，也有基于 SDXL 的版本。同时配套也很不错。有 Inpainting 模型，也有 LCM 模型等。而且生成的效果也很不错。</p>
<h2 id="DreamShaper-系列模型"><a href="#DreamShaper-系列模型" class="headerlink" title="DreamShaper 系列模型"></a>DreamShaper 系列模型</h2><p>如果只推荐一个模型的话，我会推荐 DreamShaper，首先它的成像质量不差，整体质感有点像 Midjourney。</p>
<p>其次，它的 SD v1.5 版本模型大小也不是很大，甚至比基础模型还要小一点点。</p>
<p>最后，也是我最喜欢的一点，它的配套模型比较丰富。有 LCM、Inpainting 模型，还有基于 SDXL Turbo 微调的模型。 对于电脑配置较差的朋友，我推荐你们使用 SD v1.5 的模型，即它的 V8.0 版本。</p>
<h4 id="DreamShaper-XL"><a href="#DreamShaper-XL" class="headerlink" title="DreamShaper XL"></a>DreamShaper XL</h4><p><a target="_blank" rel="noopener" href="https://civitai.com/models/112902/dreamshaper-xl">https://civitai.com/models/112902/dreamshaper-xl</a></p>
<h2 id="Realistic-风格模型"><a href="#Realistic-风格模型" class="headerlink" title="Realistic 风格模型"></a>Realistic 风格模型</h2><p>如果你主要是以生成人像为主，那么 Realistic 风格模型是一个不错的选择。他们生成的人像质量比较高，且看起来更加真实。以下是两个基于 SD v1.5 微调的模型。</p>
<p><a target="_blank" rel="noopener" href="https://civitai.com/models/43331/majicmix-realistic">https://civitai.com/models/43331/majicmix-realistic</a></p>
<p>一般你会看到两种后缀的模型：</p>
<ul>
<li><strong>safetensors</strong>：这种模型一般用的是 numpy 格式保存，这就意味着它只保存了张量数据，没有任何代码，加载这类文件会更安全和更快。</li>
<li><strong>ckpt</strong>：这种文件是序列化过的，这意味着它们可能会包含一些恶意代码，加载这类模型就可能会带来安全风险。</li>
</ul>
<p>所以在上述的案例中，我会推荐你下载 safetensors 格式的模型。</p>
<p>另外，我建议你在搜索模型的时候，需要看看是不是该模型的官方发的，一般我会看模型的下载数，一般下载数越多的模型，越有可能是官方发的。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-cn">
    <link itemprop="mainEntityOfPage" href="https://hongxing.tech/20240218-%E7%94%A8diffusers%E6%90%AD%E5%BB%BAstable%20diffusion/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="wanghongxing">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红星的个人主页">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/20240218-%E7%94%A8diffusers%E6%90%AD%E5%BB%BAstable%20diffusion/" class="post-title-link" itemprop="url">20240218-用diffusers搭建stable diffusion</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-02-18 17:25:25" itemprop="dateCreated datePublished" datetime="2024-02-18T17:25:25+08:00">2024-02-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-03-04 10:00:57" itemprop="dateModified" datetime="2024-03-04T10:00:57+08:00">2024-03-04</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>参照  <a target="_blank" rel="noopener" href="https://huggingface.co/docs/diffusers/api/pipelines/stable_diffusion/text2img#diffusers.StableDiffusionPipeline.__call__.negative_prompt">diffusers api</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">conda create -n dfu python=3.10.13</span><br><span class="line">conda activate dfu</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pip install diffusers --upgrade -i https://pypi.tuna.tsinghua.edu.cn/simple some-package</span><br><span class="line"></span><br><span class="line">pip install transformers==4.27.0 accelerate==0.12.0 invisible_watermark -i https://pypi.tuna.tsinghua.edu.cn/simple some-package</span><br><span class="line"></span><br><span class="line">conda install jupyter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pip install diffusers transformers scipy ftfy </span><br><span class="line"></span><br><span class="line">pip install git+https://github.com/huggingface/accelerate</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#读取diffuers库</span><br><span class="line">from diffusers import StableDiffusionPipeline</span><br><span class="line"></span><br><span class="line">#初始化SD模型，加载预训练权重</span><br><span class="line">pipe = StableDiffusionPipeline.from_pretrained(&quot;runwayml/stable-diffusion-v1-5&quot;)</span><br><span class="line">#使用GPU加速</span><br><span class="line">pipe.to(&quot;mps&quot;)</span><br></pre></td></tr></table></figure>





<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#接下来，我们就可以运行pipeline了</span><br><span class="line">prompt = &quot;a photograph of an astronaut riding a horse&quot;</span><br><span class="line"># Number of denoising steps</span><br><span class="line">steps = 25         </span><br><span class="line"></span><br><span class="line"># Scale for classifier-free guidance</span><br><span class="line">CFG = 7.5</span><br><span class="line">image = pipe(prompt, guidance_scale=CFG, height=512, width=768, num_inference_steps=steps).images[0]</span><br><span class="line"></span><br><span class="line"># 由于没有固定seed，每次运行代码，我们都会得到一个不同的图片。</span><br><span class="line">display(image)</span><br></pre></td></tr></table></figure>

<img src="../images/sd/20240218-whx.png" alt="20240218-whx" style="zoom:50%;" />

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">prompt = &quot;city future, 8k, exploration, cinematic, realistic, unreal engine, hyper detailed, volumetric light, moody cinematic epic concept art, realistic matte painting, hyper photorealistic&quot;</span><br><span class="line">negative_prompt =&quot;lowres, bad anatomy, text, error, extra digit, fewer digits, cropped, worst quality, low quality, normal quality, jpeg artifacts,signature, watermark, username, blurry, artist name&quot;</span><br><span class="line">steps = 20         </span><br><span class="line"></span><br><span class="line">result1 = pipe(prompt=prompt,negative_prompt=negative_prompt, guidance_scale=CFG, height=512, width=768, num_inference_steps=steps)</span><br><span class="line">image1 = result1.images[0]</span><br><span class="line"></span><br><span class="line"># 由于没有固定seed，每次运行代码，我们都会得到一个不同的图片。</span><br><span class="line">display(image1)</span><br></pre></td></tr></table></figure>

<img src="../images/sd/202402181931-001.png" alt="202402181931-001" style="zoom:50%;" />
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">wanghongxing</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">62</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">wanghongxing</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
